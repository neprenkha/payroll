# Workbook Inventory: 2025-11-08.xlsm

## Named Ranges (Workbook)

- **_xlpm.act**: `#NAME?`
- **_xlpm.actd**: `#NAME?`
- **_xlpm.actdur**: `#NAME?`
- **_xlpm.acth**: `#NAME?`
- **_xlpm.active**: `#NAME?`
- **_xlpm.addr_clean**: `#NAME?`
- **_xlpm.addr_join**: `#NAME?`
- **_xlpm.addr_line**: `#NAME?`
- **_xlpm.addr1**: `#NAME?`
- **_xlpm.addr2**: `#NAME?`
- **_xlpm.addrC**: `#NAME?`
- **_xlpm.addrJ**: `#NAME?`
- **_xlpm.addrL**: `#NAME?`
- **_xlpm.b**: `#NAME?`
- **_xlpm.base**: `#NAME?`
- **_xlpm.basechk**: `#NAME?`
- **_xlpm.baseHS**: `#NAME?`
- **_xlpm.basis**: `#NAME?`
- **_xlpm.bd**: `#NAME?`
- **_xlpm.bdH**: `#NAME?`
- **_xlpm.bdRaw**: `#NAME?`
- **_xlpm.be**: `#NAME?`
- **_xlpm.brk**: `#NAME?`
- **_xlpm.bs**: `#NAME?`
- **_xlpm.c**: `#NAME?`
- **_xlpm.c_icos**: `#NAME?`
- **_xlpm.c_vals**: `#NAME?`
- **_xlpm.city**: `#NAME?`
- **_xlpm.cnt**: `#NAME?`
- **_xlpm.code**: `#NAME?`
- **_xlpm.codes**: `#NAME?`
- **_xlpm.comp**: `#NAME?`
- **_xlpm.compnm**: `#NAME?`
- **_xlpm.country**: `#NAME?`
- **_xlpm.cred**: `#NAME?`
- **_xlpm.credd**: `#NAME?`
- **_xlpm.credh**: `#NAME?`
- **_xlpm.credit**: `#NAME?`
- **_xlpm.cy**: `#NAME?`
- **_xlpm.d**: `#NAME?`
- **_xlpm.days**: `#NAME?`
- **_xlpm.daysCnt**: `#NAME?`
- **_xlpm.daysWD**: `#NAME?`
- **_xlpm.daysWDI**: `#NAME?`
- **_xlpm.delim**: `#NAME?`
- **_xlpm.dh**: `#NAME?`
- **_xlpm.disp**: `#NAME?`
- **_xlpm.dly**: `#NAME?`
- **_xlpm.dr**: `#NAME?`
- **_xlpm.dTxt**: `#NAME?`
- **_xlpm.dur**: `#NAME?`
- **_xlpm.e**: `#NAME?`
- **_xlpm.elist**: `#NAME?`
- **_xlpm.en**: `#NAME?`
- **_xlpm.ent**: `#NAME?`
- **_xlpm.eNum**: `#NAME?`
- **_xlpm.eo**: `#NAME?`
- **_xlpm.eRaw**: `#NAME?`
- **_xlpm.eTxt**: `#NAME?`
- **_xlpm.expH**: `#NAME?`
- **_xlpm.fac**: `#NAME?`
- **_xlpm.fdDailyMask**: `#NAME?`
- **_xlpm.flags**: `#NAME?`
- **_xlpm.fri**: `#NAME?`
- **_xlpm.full**: `#NAME?`
- **_xlpm.fullH**: `#NAME?`
- **_xlpm.gap**: `#NAME?`
- **_xlpm.grp**: `#NAME?`
- **_xlpm.h**: `#NAME?`
- **_xlpm.handle**: `#NAME?`
- **_xlpm.has**: `#NAME?`
- **_xlpm.hasEO**: `#NAME?`
- **_xlpm.hasTI**: `#NAME?`
- **_xlpm.hasTime**: `#NAME?`
- **_xlpm.hasWD**: `#NAME?`
- **_xlpm.hasWDI**: `#NAME?`
- **_xlpm.hd**: `#NAME?`
- **_xlpm.hdMask**: `#NAME?`
- **_xlpm.hours**: `#NAME?`
- **_xlpm.hoursRow**: `#NAME?`
- **_xlpm.hpd**: `#NAME?`
- **_xlpm.hpdRaw**: `#NAME?`
- **_xlpm.hr**: `#NAME?`
- **_xlpm.hrs**: `#NAME?`
- **_xlpm.hs**: `#NAME?`
- **_xlpm.hsD**: `#NAME?`
- **_xlpm.hsDays**: `#NAME?`
- **_xlpm.hsH**: `#NAME?`
- **_xlpm.hsRaw**: `#NAME?`
- **_xlpm.hTxt**: `#NAME?`
- **_xlpm.hWD**: `#NAME?`
- **_xlpm.hWDI**: `#NAME?`
- **_xlpm.icos**: `#NAME?`
- **_xlpm.idx**: `#NAME?`
- **_xlpm.In**: `#NAME?`
- **_xlpm.indDy**: `#NAME?`
- **_xlpm.indHr**: `#NAME?`
- **_xlpm.isH**: `#NAME?`
- **_xlpm.isph**: `#NAME?`
- **_xlpm.isPHbase**: `#NAME?`
- **_xlpm.isPHpay**: `#NAME?`
- **_xlpm.isPHprev**: `#NAME?`
- **_xlpm.isPHrepl**: `#NAME?`
- **_xlpm.isPHreplMask**: `#NAME?`
- **_xlpm.isPHtoday**: `#NAME?`
- **_xlpm.isRest**: `#NAME?`
- **_xlpm.isWorkDay**: `#NAME?`
- **_xlpm.j**: `#NAME?`
- **_xlpm.kind**: `#NAME?`
- **_xlpm.L**: `#NAME?`
- **_xlpm.lab**: `#NAME?`
- **_xlpm.label**: `#NAME?`
- **_xlpm.labels**: `#NAME?`
- **_xlpm.lastOffDOW**: `#NAME?`
- **_xlpm.lbl**: `#NAME?`
- **_xlpm.lbls**: `#NAME?`
- **_xlpm.leaveMask**: `#NAME?`
- **_xlpm.line3**: `#NAME?`
- **_xlpm.line4**: `#NAME?`
- **_xlpm.m**: `#NAME?`
- **_xlpm.mapC**: `#NAME?`
- **_xlpm.mask**: `#NAME?`
- **_xlpm.mn**: `#NAME?`
- **_xlpm.mon**: `#NAME?`
- **_xlpm.months**: `#NAME?`
- **_xlpm.mpwt**: `#NAME?`
- **_xlpm.msk**: `#NAME?`
- **_xlpm.N**: `#NAME?`
- **_xlpm.names**: `#NAME?`
- **_xlpm.nb**: `#NAME?`
- **_xlpm.nbe**: `#NAME?`
- **_xlpm.nbs**: `#NAME?`
- **_xlpm.neo**: `#NAME?`
- **_xlpm.nm**: `#NAME?`
- **_xlpm.nmWD**: `#NAME?`
- **_xlpm.nmWDI**: `#NAME?`
- **_xlpm.normH**: `#NAME?`
- **_xlpm.nrmH**: `#NAME?`
- **_xlpm.nti**: `#NAME?`
- **_xlpm.obs**: `#NAME?`
- **_xlpm.obsFlag**: `#NAME?`
- **_xlpm.obsPH**: `#NAME?`
- **_xlpm.off**: `#NAME?`
- **_xlpm.offD**: `#NAME?`
- **_xlpm.offDm1**: `#NAME?`
- **_xlpm.offFri**: `#NAME?`
- **_xlpm.offMap**: `#NAME?`
- **_xlpm.offMon**: `#NAME?`
- **_xlpm.offPm1**: `#NAME?`
- **_xlpm.offSat**: `#NAME?`
- **_xlpm.offSun**: `#NAME?`
- **_xlpm.offT**: `#NAME?`
- **_xlpm.offThu**: `#NAME?`
- **_xlpm.offToday**: `#NAME?`
- **_xlpm.offTodayTxt**: `#NAME?`
- **_xlpm.offTue**: `#NAME?`
- **_xlpm.offVec**: `#NAME?`
- **_xlpm.offWed**: `#NAME?`
- **_xlpm.offYest**: `#NAME?`
- **_xlpm.opt**: `#NAME?`
- **_xlpm.Out**: `#NAME?`
- **_xlpm.ov**: `#NAME?`
- **_xlpm.path**: `#NAME?`
- **_xlpm.pay**: `#NAME?`
- **_xlpm.ph**: `#NAME?`
- **_xlpm.phMask**: `#NAME?`
- **_xlpm.postc**: `#NAME?`
- **_xlpm.pr**: `#NAME?`
- **_xlpm.prio**: `#NAME?`
- **_xlpm.prior**: `#NAME?`
- **_xlpm.ps**: `#NAME?`
- **_xlpm.pt**: `#NAME?`
- **_xlpm.pvals**: `#NAME?`
- **_xlpm.q**: `#NAME?`
- **_xlpm.r**: `#NAME?`
- **_xlpm.rate**: `#NAME?`
- **_xlpm.ratePerRow**: `#NAME?`
- **_xlpm.refs**: `#NAME?`
- **_xlpm.repl**: `#NAME?`
- **_xlpm.req**: `#NAME?`
- **_xlpm.reqd**: `#NAME?`
- **_xlpm.reqd_raw**: `#NAME?`
- **_xlpm.reqh**: `#NAME?`
- **_xlpm.reqraw**: `#NAME?`
- **_xlpm.restDOW**: `#NAME?`
- **_xlpm.restIdx**: `#NAME?`
- **_xlpm.restPrev**: `#NAME?`
- **_xlpm.result**: `#NAME?`
- **_xlpm.rng**: `#NAME?`
- **_xlpm.rows**: `#NAME?`
- **_xlpm.s**: `#NAME?`
- **_xlpm.s_icos**: `#NAME?`
- **_xlpm.s_vals**: `#NAME?`
- **_xlpm.sal**: `#NAME?`
- **_xlpm.sameAll**: `#NAME?`
- **_xlpm.sat**: `#NAME?`
- **_xlpm.secondLastOffDOW**: `#NAME?`
- **_xlpm.seen**: `#NAME?`
- **_xlpm.selName**: `#NAME?`
- **_xlpm.sep**: `#NAME?`
- **_xlpm.sh**: `#NAME?`
- **_xlpm.shortd**: `#NAME?`
- **_xlpm.shortDays**: `#NAME?`
- **_xlpm.shortH**: `#NAME?`
- **_xlpm.shortWD**: `#NAME?`
- **_xlpm.shortWDI**: `#NAME?`
- **_xlpm.shs**: `#NAME?`
- **_xlpm.sorted**: `#NAME?`
- **_xlpm.sp**: `#NAME?`
- **_xlpm.sS**: `#NAME?`
- **_xlpm.st**: `#NAME?`
- **_xlpm.state**: `#NAME?`
- **_xlpm.status**: `#NAME?`
- **_xlpm.sumh**: `#NAME?`
- **_xlpm.sun**: `#NAME?`
- **_xlpm.t**: `#NAME?`
- **_xlpm.taken**: `#NAME?`
- **_xlpm.th**: `#NAME?`
- **_xlpm.thH**: `#NAME?`
- **_xlpm.thRaw**: `#NAME?`
- **_xlpm.thu**: `#NAME?`
- **_xlpm.ti**: `#NAME?`
- **_xlpm.tot**: `#NAME?`
- **_xlpm.total**: `#NAME?`
- **_xlpm.totalH**: `#NAME?`
- **_xlpm.totHrs**: `#NAME?`
- **_xlpm.tue**: `#NAME?`
- **_xlpm.u**: `#NAME?`
- **_xlpm.uCnt**: `#NAME?`
- **_xlpm.v**: `#NAME?`
- **_xlpm.vA**: `#NAME?`
- **_xlpm.val**: `#NAME?`
- **_xlpm.vals**: `#NAME?`
- **_xlpm.vD**: `#NAME?`
- **_xlpm.vG**: `#NAME?`
- **_xlpm.vJ**: `#NAME?`
- **_xlpm.vs**: `#NAME?`
- **_xlpm.w**: `#NAME?`
- **_xlpm.wd**: `#NAME?`
- **_xlpm.wdH**: `#NAME?`
- **_xlpm.wdiH**: `#NAME?`
- **_xlpm.wdiName**: `#NAME?`
- **_xlpm.wdName**: `#NAME?`
- **_xlpm.wdOff**: `#NAME?`
- **_xlpm.wed**: `#NAME?`
- **_xlpm.wh**: `#NAME?`
- **_xlpm.woFlags**: `#NAME?`
- **_xlpm.workd**: `#NAME?`
- **_xlpm.wpd**: `#NAME?`
- **_xlpm.wpd_raw**: `#NAME?`
- **_xlpm.wph**: `#NAME?`
- **_xlpm.yr**: `#NAME?`
- **_xlpm.z**: `#NAME?`
- **AttendanceList**: `staffsettings!$L$6:INDEX(staffsettings!$L:$L, MATCH("zzz", staffsettings!$I:$I))`
- **OTTypeList**: `OFFSET(staffsettings!$AN$2,0,0,COUNTA(staffsettings!$AM$2:$AM$200),1)`
- **PayStructureList**: `OFFSET(staffsettings!$T$21,0,0,COUNTA(staffsettings!$T$21:$T$200),1)`

## Sheet: 05

### Summary
- **Used range**: `A1:Y50`
- **Excel Tables**: None

### Formulas
- `T2`: A1=`companysettings!$B$3`; R1C1=`(not available in source)` (Row header: TOTAL)
- `Y2`: A1=`UPPER("PAYSLIP - "&TEXT(DATE(companysettings!$N$2,VALUE(MID(CELL("filename",A1),FIND("]",CELL("filename",A1))+1,2)),1),"mmmm yyyy"))`; R1C1=`(not available in source)` (Row header: SA0019087-A)
- `A3`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A2),FIND("]",CELL("filename",A2))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: DATE)
- `C3`: A1=`IF($A3="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: BS)
- `D3`: A1=`IF($A3="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: BE)
- `F3`: A1=`IF($A3="","",
 _xlfn.LET(
  _xlpm.d,$A3,
  _xlpm.ti,$B3, _xlpm.eo,$E3, _xlpm.bs,$C3, _xlpm.be,$D3,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K3)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: HS)
- `G3`: A1=`IF($A3="","",IF($H3<>"",$H3,IF($E3<>"",$E3,"")))`; R1C1=`(not available in source)` (Column header: OT/I)
- `J3`: A1=`IF(OR($A3="",$G3="",$I3=""),"",
  _xlfn.LET(
    _xlpm.st,$G3,_xlpm.en,$I3,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: OT/H)
- `N3`: A1=`F3`; R1C1=`(not available in source)` (Column header: Note)
- `A4`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A3),FIND("]",CELL("filename",A3))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44316)
- `B4`: A1=`$B$3`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C4`: A1=`IF($A4="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D4`: A1=`IF($A4="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E4`: A1=`$E$3`; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F4`: A1=`IF($A4="","",
 _xlfn.LET(
  _xlpm.d,$A4,
  _xlpm.ti,$B4, _xlpm.eo,$E4, _xlpm.bs,$C4, _xlpm.be,$D4,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K4)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G4`: A1=`IF($A4="","",IF($H4<>"",$H4,IF($E4<>"",$E4,"")))`; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J4`: A1=`IF(OR($A4="",$G4="",$I4=""),"",
  _xlfn.LET(
    _xlpm.st,$G4,_xlpm.en,$I4,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N4`: A1=`F4`; R1C1=`(not available in source)` (Column header: 0)
- `A5`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A4),FIND("]",CELL("filename",A4))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44317)
- `B5`: A1=`$B$3`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C5`: A1=`IF($A5="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D5`: A1=`IF($A5="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E5`: A1=`$E$3`; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F5`: A1=`IF($A5="","",
 _xlfn.LET(
  _xlpm.d,$A5,
  _xlpm.ti,$B5, _xlpm.eo,$E5, _xlpm.bs,$C5, _xlpm.be,$D5,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K5)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G5`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J5`: A1=`IF(OR($A5="",$G5="",$I5=""),"",
  _xlfn.LET(
    _xlpm.st,$G5,_xlpm.en,$I5,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N5`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `T5`: A1=`Line1()&CHAR(10)&Line2()&CHAR(10)&SocialLine()`; R1C1=`(not available in source)` (Column header: SA0019087-A)
- `A6`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A5),FIND("]",CELL("filename",A5))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44318)
- `B6`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C6`: A1=`IF($A6="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D6`: A1=`IF($A6="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E6`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F6`: A1=`IF($A6="","",
 _xlfn.LET(
  _xlpm.d,$A6,
  _xlpm.ti,$B6, _xlpm.eo,$E6, _xlpm.bs,$C6, _xlpm.be,$D6,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K6)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G6`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J6`: A1=`IF(OR($A6="",$G6="",$I6=""),"",
  _xlfn.LET(
    _xlpm.st,$G6,_xlpm.en,$I6,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N6`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A7`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A6),FIND("]",CELL("filename",A6))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44319)
- `B7`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C7`: A1=`IF($A7="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D7`: A1=`IF($A7="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E7`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F7`: A1=`IF($A7="","",
 _xlfn.LET(
  _xlpm.d,$A7,
  _xlpm.ti,$B7, _xlpm.eo,$E7, _xlpm.bs,$C7, _xlpm.be,$D7,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K7)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G7`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J7`: A1=`IF(OR($A7="",$G7="",$I7=""),"",
  _xlfn.LET(
    _xlpm.st,$G7,_xlpm.en,$I7,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N7`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A8`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A7),FIND("]",CELL("filename",A7))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44320)
- `B8`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C8`: A1=`IF($A8="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D8`: A1=`IF($A8="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E8`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F8`: A1=`IF($A8="","",
 _xlfn.LET(
  _xlpm.d,$A8,
  _xlpm.ti,$B8, _xlpm.eo,$E8, _xlpm.bs,$C8, _xlpm.be,$D8,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K8)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G8`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J8`: A1=`IF(OR($A8="",$G8="",$I8=""),"",
  _xlfn.LET(
    _xlpm.st,$G8,_xlpm.en,$I8,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N8`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A9`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A8),FIND("]",CELL("filename",A8))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44321)
- `B9`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C9`: A1=`IF($A9="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D9`: A1=`IF($A9="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E9`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F9`: A1=`IF($A9="","",
 _xlfn.LET(
  _xlpm.d,$A9,
  _xlpm.ti,$B9, _xlpm.eo,$E9, _xlpm.bs,$C9, _xlpm.be,$D9,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K9)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G9`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J9`: A1=`IF(OR($A9="",$G9="",$I9=""),"",
  _xlfn.LET(
    _xlpm.st,$G9,_xlpm.en,$I9,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N9`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A10`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A9),FIND("]",CELL("filename",A9))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44322)
- `B10`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C10`: A1=`IF($A10="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D10`: A1=`IF($A10="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E10`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F10`: A1=`IF($A10="","",
 _xlfn.LET(
  _xlpm.d,$A10,
  _xlpm.ti,$B10, _xlpm.eo,$E10, _xlpm.bs,$C10, _xlpm.be,$D10,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K10)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G10`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J10`: A1=`IF(OR($A10="",$G10="",$I10=""),"",
  _xlfn.LET(
    _xlpm.st,$G10,_xlpm.en,$I10,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N10`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A11`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A10),FIND("]",CELL("filename",A10))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44323)
- `B11`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C11`: A1=`IF($A11="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D11`: A1=`IF($A11="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E11`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F11`: A1=`IF($A11="","",
 _xlfn.LET(
  _xlpm.d,$A11,
  _xlpm.ti,$B11, _xlpm.eo,$E11, _xlpm.bs,$C11, _xlpm.be,$D11,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K11)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G11`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J11`: A1=`IF(OR($A11="",$G11="",$I11=""),"",
  _xlfn.LET(
    _xlpm.st,$G11,_xlpm.en,$I11,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N11`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `T11`: A1=`IF(COUNTA($M$3:$M$33)=0,"",
 _xlfn._xlws.FILTER(
  staffsettings!$S$2:$S$20,
  COUNTIF($M$3:$M$33, staffsettings!$T$2:$T$20)>0
 )
)`; R1C1=`(not available in source)` (Column header: BASIC)
- `U11`: A1=`IF(T11="","",
 _xlfn.LET(
  _xlpm.h,
   IF(ISTEXT(staffsettings!$V$2),
      IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
      IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
   ),

  _xlpm.wdH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WD")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.wdiH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WDI")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.label, T11,

  _xlpm.val,
   IF(_xlpm.label="Work Hours",_xlpm.wdH,
    IF(_xlpm.label="Work Days",IF(_xlpm.wdH="","",ROUND(_xlpm.wdH/_xlpm.h,2)),
     IF(_xlpm.label="Work Hours - Indoor",_xlpm.wdiH,
      IF(_xlpm.label="Work Days - Indoor",IF(_xlpm.wdiH="","",ROUND(_xlpm.wdiH/_xlpm.h,2)),"")
     )
    )
   ),

  IF(OR(_xlpm.val="",_xlpm.val=0),"",_xlpm.val)
 )
)`; R1C1=`(not available in source)` (Row header: Work Days)
- `A12`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A11),FIND("]",CELL("filename",A11))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44324)
- `B12`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C12`: A1=`IF($A12="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D12`: A1=`IF($A12="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E12`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F12`: A1=`IF($A12="","",
 _xlfn.LET(
  _xlpm.d,$A12,
  _xlpm.ti,$B12, _xlpm.eo,$E12, _xlpm.bs,$C12, _xlpm.be,$D12,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K12)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G12`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J12`: A1=`IF(OR($A12="",$G12="",$I12=""),"",
  _xlfn.LET(
    _xlpm.st,$G12,_xlpm.en,$I12,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N12`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U12`: A1=`IF(T12="","",
 _xlfn.LET(
  _xlpm.h,
   IF(ISTEXT(staffsettings!$V$2),
      IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
      IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
   ),

  _xlpm.wdH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WD")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.wdiH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WDI")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.label, T12,

  _xlpm.val,
   IF(_xlpm.label="Work Hours",_xlpm.wdH,
    IF(_xlpm.label="Work Days",IF(_xlpm.wdH="","",ROUND(_xlpm.wdH/_xlpm.h,2)),
     IF(_xlpm.label="Work Hours - Indoor",_xlpm.wdiH,
      IF(_xlpm.label="Work Days - Indoor",IF(_xlpm.wdiH="","",ROUND(_xlpm.wdiH/_xlpm.h,2)),"")
     )
    )
   ),

  IF(OR(_xlpm.val="",_xlpm.val=0),"",_xlpm.val)
 )
)`; R1C1=`(not available in source)` (Column header: 4)
- `V12`: A1=`IF(U12="","",
 _xlfn.LET(
   _xlpm.lbl, T12,
   _xlpm.ps, IFERROR(
         INDEX(staffsettings!$T$2:$T$20,
               MATCH(_xlpm.lbl,staffsettings!$S$2:$S$20,0)
         ),
         ""
       ),
   _xlpm.rate, IF(_xlpm.ps="WD",$F$40,
           IF(_xlpm.ps="WDI",$F$44,0)
   ),
   U12*_xlpm.rate
 )
)`; R1C1=`(not available in source)` (Row header: 32)
- `A13`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A12),FIND("]",CELL("filename",A12))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44325)
- `B13`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C13`: A1=`IF($A13="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D13`: A1=`IF($A13="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E13`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F13`: A1=`IF($A13="","",
 _xlfn.LET(
  _xlpm.d,$A13,
  _xlpm.ti,$B13, _xlpm.eo,$E13, _xlpm.bs,$C13, _xlpm.be,$D13,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K13)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G13`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J13`: A1=`IF(OR($A13="",$G13="",$I13=""),"",
  _xlfn.LET(
    _xlpm.st,$G13,_xlpm.en,$I13,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N13`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U13`: A1=`IF(T13="","",
 _xlfn.LET(
  _xlpm.h,
   IF(ISTEXT(staffsettings!$V$2),
      IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
      IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
   ),

  _xlpm.wdH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WD")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.wdiH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WDI")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.label, T13,

  _xlpm.val,
   IF(_xlpm.label="Work Hours",_xlpm.wdH,
    IF(_xlpm.label="Work Days",IF(_xlpm.wdH="","",ROUND(_xlpm.wdH/_xlpm.h,2)),
     IF(_xlpm.label="Work Hours - Indoor",_xlpm.wdiH,
      IF(_xlpm.label="Work Days - Indoor",IF(_xlpm.wdiH="","",ROUND(_xlpm.wdiH/_xlpm.h,2)),"")
     )
    )
   ),

  IF(OR(_xlpm.val="",_xlpm.val=0),"",_xlpm.val)
 )
)`; R1C1=`(not available in source)` (Column header: 32)
- `A14`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A13),FIND("]",CELL("filename",A13))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44326)
- `B14`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C14`: A1=`IF($A14="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D14`: A1=`IF($A14="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E14`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F14`: A1=`IF($A14="","",
 _xlfn.LET(
  _xlpm.d,$A14,
  _xlpm.ti,$B14, _xlpm.eo,$E14, _xlpm.bs,$C14, _xlpm.be,$D14,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K14)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G14`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J14`: A1=`IF(OR($A14="",$G14="",$I14=""),"",
  _xlfn.LET(
    _xlpm.st,$G14,_xlpm.en,$I14,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N14`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U14`: A1=`IF(T14="","",
 _xlfn.LET(
  _xlpm.h,
   IF(ISTEXT(staffsettings!$V$2),
      IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
      IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
   ),

  _xlpm.wdH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WD")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.wdiH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WDI")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.label, T14,

  _xlpm.val,
   IF(_xlpm.label="Work Hours",_xlpm.wdH,
    IF(_xlpm.label="Work Days",IF(_xlpm.wdH="","",ROUND(_xlpm.wdH/_xlpm.h,2)),
     IF(_xlpm.label="Work Hours - Indoor",_xlpm.wdiH,
      IF(_xlpm.label="Work Days - Indoor",IF(_xlpm.wdiH="","",ROUND(_xlpm.wdiH/_xlpm.h,2)),"")
     )
    )
   ),

  IF(OR(_xlpm.val="",_xlpm.val=0),"",_xlpm.val)
 )
)`; R1C1=`(not available in source)` (Column header: 58)
- `V14`: A1=`IF(U14="","",
 _xlfn.LET(
   _xlpm.lbl, T14,
   _xlpm.ps, IFERROR(
         INDEX(staffsettings!$T$2:$T$20,
               MATCH(_xlpm.lbl,staffsettings!$S$2:$S$20,0)
         ),
         ""
       ),
   _xlpm.rate, IF(_xlpm.ps="WD",$F$40,
           IF(_xlpm.ps="WDI",$F$44,0)
   ),
   U14*_xlpm.rate
 )
)`; R1C1=`(not available in source)` (Column header: 327.27272727272725)
- `A15`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A14),FIND("]",CELL("filename",A14))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44327)
- `B15`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C15`: A1=`IF($A15="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D15`: A1=`IF($A15="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E15`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F15`: A1=`IF($A15="","",
 _xlfn.LET(
  _xlpm.d,$A15,
  _xlpm.ti,$B15, _xlpm.eo,$E15, _xlpm.bs,$C15, _xlpm.be,$D15,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K15)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G15`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J15`: A1=`IF(OR($A15="",$G15="",$I15=""),"",
  _xlfn.LET(
    _xlpm.st,$G15,_xlpm.en,$I15,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N15`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `V15`: A1=`IF(AND($U$11="",$U$13=""),"",
 (IF($U$11="",0,$U$12*$F$40)) +
 (IF($U$13="",0,$U$14*$F$44))
)`; R1C1=`(not available in source)` (Column header: 4060)
- `A16`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A15),FIND("]",CELL("filename",A15))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44328)
- `B16`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C16`: A1=`IF($A16="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D16`: A1=`IF($A16="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E16`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F16`: A1=`IF($A16="","",
 _xlfn.LET(
  _xlpm.d,$A16,
  _xlpm.ti,$B16, _xlpm.eo,$E16, _xlpm.bs,$C16, _xlpm.be,$D16,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K16)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G16`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J16`: A1=`IF(OR($A16="",$G16="",$I16=""),"",
  _xlfn.LET(
    _xlpm.st,$G16,_xlpm.en,$I16,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N16`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A17`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A16),FIND("]",CELL("filename",A16))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44329)
- `C17`: A1=`IF($A17="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D17`: A1=`IF($A17="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E17`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F17`: A1=`IF($A17="","",
 _xlfn.LET(
  _xlpm.d,$A17,
  _xlpm.ti,$B17, _xlpm.eo,$E17, _xlpm.bs,$C17, _xlpm.be,$D17,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K17)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G17`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J17`: A1=`IF(OR($A17="",$G17="",$I17=""),"",
  _xlfn.LET(
    _xlpm.st,$G17,_xlpm.en,$I17,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N17`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A18`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A17),FIND("]",CELL("filename",A17))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44330)
- `C18`: A1=`IF($A18="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D18`: A1=`IF($A18="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E18`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F18`: A1=`IF($A18="","",
 _xlfn.LET(
  _xlpm.d,$A18,
  _xlpm.ti,$B18, _xlpm.eo,$E18, _xlpm.bs,$C18, _xlpm.be,$D18,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K18)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G18`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J18`: A1=`IF(OR($A18="",$G18="",$I18=""),"",
  _xlfn.LET(
    _xlpm.st,$G18,_xlpm.en,$I18,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N18`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `T18`: A1=`IF(COUNTA($L$3:$L$33)=0,"",
 _xlfn.LET(
   _xlpm.codes,_xlfn.UNIQUE(_xlfn._xlws.FILTER($L$3:$L$33,$L$3:$L$33<>"")),
   _xlpm.idx,MATCH(_xlpm.codes,staffsettings!$AN$2:$AN$6,0),
   _xlpm.names,INDEX(staffsettings!$AM$2:$AM$6,_xlpm.idx),
   _xlpm.prior,INDEX(staffsettings!$AL$2:$AL$6,_xlpm.idx),
   _xlpm.sorted,_xlfn._xlws.SORT(CHOOSE({1,2},_xlpm.names,_xlpm.prior),2,TRUE),
   INDEX(_xlpm.sorted,,1)
 )
)`; R1C1=`(not available in source)` (Column header: OVERTIME)
- `U18`: A1=`IF(T18="","",
 _xlfn.LET(
   _xlpm.nm,T18,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: Hrs)
- `V18`: A1=`IF(T18="","",
 _xlfn.LET(
  _xlpm.nm,T18,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 4387.272727272727)
- `A19`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A18),FIND("]",CELL("filename",A18))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44331)
- `C19`: A1=`IF($A19="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D19`: A1=`IF($A19="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E19`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F19`: A1=`IF($A19="","",
 _xlfn.LET(
  _xlpm.d,$A19,
  _xlpm.ti,$B19, _xlpm.eo,$E19, _xlpm.bs,$C19, _xlpm.be,$D19,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K19)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G19`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J19`: A1=`IF(OR($A19="",$G19="",$I19=""),"",
  _xlfn.LET(
    _xlpm.st,$G19,_xlpm.en,$I19,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N19`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `U19`: A1=`IF(T19="","",
 _xlfn.LET(
   _xlpm.nm,T19,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `V19`: A1=`IF(T19="","",
 _xlfn.LET(
  _xlpm.nm,T19,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 51.24)
- `A20`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A19),FIND("]",CELL("filename",A19))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44332)
- `C20`: A1=`IF($A20="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D20`: A1=`IF($A20="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E20`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F20`: A1=`IF($A20="","",
 _xlfn.LET(
  _xlpm.d,$A20,
  _xlpm.ti,$B20, _xlpm.eo,$E20, _xlpm.bs,$C20, _xlpm.be,$D20,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K20)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G20`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J20`: A1=`IF(OR($A20="",$G20="",$I20=""),"",
  _xlfn.LET(
    _xlpm.st,$G20,_xlpm.en,$I20,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N20`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U20`: A1=`IF(T20="","",
 _xlfn.LET(
   _xlpm.nm,T20,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `V20`: A1=`IF(T20="","",
 _xlfn.LET(
  _xlpm.nm,T20,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 63)
- `A21`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A20),FIND("]",CELL("filename",A20))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44333)
- `C21`: A1=`IF($A21="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D21`: A1=`IF($A21="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E21`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F21`: A1=`IF($A21="","",
 _xlfn.LET(
  _xlpm.d,$A21,
  _xlpm.ti,$B21, _xlpm.eo,$E21, _xlpm.bs,$C21, _xlpm.be,$D21,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K21)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G21`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J21`: A1=`IF(OR($A21="",$G21="",$I21=""),"",
  _xlfn.LET(
    _xlpm.st,$G21,_xlpm.en,$I21,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N21`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U21`: A1=`IF(T21="","",
 _xlfn.LET(
   _xlpm.nm,T21,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `V21`: A1=`IF(T21="","",
 _xlfn.LET(
  _xlpm.nm,T21,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 78.75)
- `A22`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A21),FIND("]",CELL("filename",A21))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44334)
- `C22`: A1=`IF($A22="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D22`: A1=`IF($A22="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E22`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F22`: A1=`IF($A22="","",
 _xlfn.LET(
  _xlpm.d,$A22,
  _xlpm.ti,$B22, _xlpm.eo,$E22, _xlpm.bs,$C22, _xlpm.be,$D22,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K22)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G22`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J22`: A1=`IF(OR($A22="",$G22="",$I22=""),"",
  _xlfn.LET(
    _xlpm.st,$G22,_xlpm.en,$I22,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N22`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `U22`: A1=`IF(T22="","",
 _xlfn.LET(
   _xlpm.nm,T22,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `V22`: A1=`IF(T22="","",
 _xlfn.LET(
  _xlpm.nm,T22,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 94.5)
- `A23`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A22),FIND("]",CELL("filename",A22))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44335)
- `C23`: A1=`IF($A23="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D23`: A1=`IF($A23="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E23`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F23`: A1=`IF($A23="","",
 _xlfn.LET(
  _xlpm.d,$A23,
  _xlpm.ti,$B23, _xlpm.eo,$E23, _xlpm.bs,$C23, _xlpm.be,$D23,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K23)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G23`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J23`: A1=`IF(OR($A23="",$G23="",$I23=""),"",
  _xlfn.LET(
    _xlpm.st,$G23,_xlpm.en,$I23,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N23`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `U23`: A1=`IF(T23="","",
 _xlfn.LET(
  _xlpm.nm,T23,
  _xlpm.code,IFERROR(
         INDEX(staffsettings!$AN$2:$AN$6,MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
         INDEX(staffsettings!$AN$2:$AN$6,MATCH(_xlpm.nm,staffsettings!$AO$2:$AO$6,0))
       ),
  SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `A24`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A23),FIND("]",CELL("filename",A23))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44336)
- `C24`: A1=`IF($A24="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D24`: A1=`IF($A24="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E24`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F24`: A1=`IF($A24="","",
 _xlfn.LET(
  _xlpm.d,$A24,
  _xlpm.ti,$B24, _xlpm.eo,$E24, _xlpm.bs,$C24, _xlpm.be,$D24,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K24)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G24`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J24`: A1=`IF(OR($A24="",$G24="",$I24=""),"",
  _xlfn.LET(
    _xlpm.st,$G24,_xlpm.en,$I24,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N24`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A25`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A24),FIND("]",CELL("filename",A24))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44337)
- `C25`: A1=`IF($A25="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D25`: A1=`IF($A25="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E25`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F25`: A1=`IF($A25="","",
 _xlfn.LET(
  _xlpm.d,$A25,
  _xlpm.ti,$B25, _xlpm.eo,$E25, _xlpm.bs,$C25, _xlpm.be,$D25,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K25)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G25`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J25`: A1=`IF(OR($A25="",$G25="",$I25=""),"",
  _xlfn.LET(
    _xlpm.st,$G25,_xlpm.en,$I25,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N25`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A26`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A25),FIND("]",CELL("filename",A25))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44338)
- `C26`: A1=`IF($A26="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D26`: A1=`IF($A26="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E26`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F26`: A1=`IF($A26="","",
 _xlfn.LET(
  _xlpm.d,$A26,
  _xlpm.ti,$B26, _xlpm.eo,$E26, _xlpm.bs,$C26, _xlpm.be,$D26,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K26)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G26`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J26`: A1=`IF(OR($A26="",$G26="",$I26=""),"",
  _xlfn.LET(
    _xlpm.st,$G26,_xlpm.en,$I26,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N26`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A27`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A26),FIND("]",CELL("filename",A26))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44339)
- `C27`: A1=`IF($A27="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D27`: A1=`IF($A27="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E27`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F27`: A1=`IF($A27="","",
 _xlfn.LET(
  _xlpm.d,$A27,
  _xlpm.ti,$B27, _xlpm.eo,$E27, _xlpm.bs,$C27, _xlpm.be,$D27,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K27)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G27`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J27`: A1=`IF(OR($A27="",$G27="",$I27=""),"",
  _xlfn.LET(
    _xlpm.st,$G27,_xlpm.en,$I27,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N27`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A28`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A27),FIND("]",CELL("filename",A27))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44340)
- `C28`: A1=`IF($A28="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D28`: A1=`IF($A28="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E28`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F28`: A1=`IF($A28="","",
 _xlfn.LET(
  _xlpm.d,$A28,
  _xlpm.ti,$B28, _xlpm.eo,$E28, _xlpm.bs,$C28, _xlpm.be,$D28,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K28)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G28`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J28`: A1=`IF(OR($A28="",$G28="",$I28=""),"",
  _xlfn.LET(
    _xlpm.st,$G28,_xlpm.en,$I28,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N28`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A29`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A28),FIND("]",CELL("filename",A28))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44341)
- `C29`: A1=`IF($A29="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D29`: A1=`IF($A29="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E29`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F29`: A1=`IF($A29="","",
 _xlfn.LET(
  _xlpm.d,$A29,
  _xlpm.ti,$B29, _xlpm.eo,$E29, _xlpm.bs,$C29, _xlpm.be,$D29,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K29)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G29`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J29`: A1=`IF(OR($A29="",$G29="",$I29=""),"",
  _xlfn.LET(
    _xlpm.st,$G29,_xlpm.en,$I29,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N29`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A30`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A29),FIND("]",CELL("filename",A29))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44342)
- `C30`: A1=`IF($A30="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D30`: A1=`IF($A30="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E30`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F30`: A1=`IF($A30="","",
 _xlfn.LET(
  _xlpm.d,$A30,
  _xlpm.ti,$B30, _xlpm.eo,$E30, _xlpm.bs,$C30, _xlpm.be,$D30,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K30)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G30`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J30`: A1=`IF(OR($A30="",$G30="",$I30=""),"",
  _xlfn.LET(
    _xlpm.st,$G30,_xlpm.en,$I30,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N30`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `W30`: A1=`_xlfn.LET(
 _xlpm.lbl, {"Full Name";"Staff ID";"IC/Passport";"Join Date";"Department";"Designation";"Bank Name";"Bank Account";"Annual Leave Balance (days)"},
 _xlpm.vA, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$A:$A, staffsettings!$B:$B, ""),
 _xlpm.vD, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$D:$D, staffsettings!$E:$E, ""),
 _xlpm.vG, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$G:$G, staffsettings!$H:$H, ""),
 _xlpm.vJ, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$J:$J, staffsettings!$K:$K, ""),
 _xlpm.val, IF(_xlpm.vA<>"",_xlpm.vA,IF(_xlpm.vD<>"",_xlpm.vD,IF(_xlpm.vG<>"",_xlpm.vG,_xlpm.vJ))),
 _xlfn._xlws.FILTER(_xlpm.lbl, _xlpm.val<>"")
)`; R1C1=`(not available in source)` (Column header: DEDUCTIONS)
- `Y30`: A1=`_xlfn.LET(
 _xlpm.lbl, {"Full Name";"Staff ID";"IC/Passport";"Join Date";"Department";"Designation";"Bank Name";"Bank Account";"Annual Leave Balance (days)"},
 _xlpm.vA, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$A:$A, staffsettings!$B:$B, ""),
 _xlpm.vD, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$D:$D, staffsettings!$E:$E, ""),
 _xlpm.vG, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$G:$G, staffsettings!$H:$H, ""),
 _xlpm.vJ, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$J:$J, staffsettings!$K:$K, ""),
 _xlpm.val, IF(_xlpm.vA<>"",_xlpm.vA,IF(_xlpm.vD<>"",_xlpm.vD,IF(_xlpm.vG<>"",_xlpm.vG,_xlpm.vJ))),
 _xlpm.disp, IF(_xlpm.lbl="Bank Account", IF(_xlpm.val="","", IF(ISTEXT(_xlpm.val), _xlpm.val, TEXT(_xlpm.val, REPT("0",12)))), _xlpm.val),
 _xlfn._xlws.FILTER(_xlpm.disp, _xlpm.val<>"")
)`; R1C1=`(not available in source)` (Column header: PAYSLIP - MAY 2025)
- `A31`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A30),FIND("]",CELL("filename",A30))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44343)
- `C31`: A1=`IF($A31="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D31`: A1=`IF($A31="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E31`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F31`: A1=`IF($A31="","",
 _xlfn.LET(
  _xlpm.d,$A31,
  _xlpm.ti,$B31, _xlpm.eo,$E31, _xlpm.bs,$C31, _xlpm.be,$D31,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K31)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G31`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J31`: A1=`IF(OR($A31="",$G31="",$I31=""),"",
  _xlfn.LET(
    _xlpm.st,$G31,_xlpm.en,$I31,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N31`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `W31`: A1=``; R1C1=`(not available in source)` (Column header: Full Name)
- `Y31`: A1=``; R1C1=`(not available in source)` (Column header: MOHD AZLIN NASUTION BIN ABDUL AZIZ)
- `A32`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A31),FIND("]",CELL("filename",A31))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44344)
- `C32`: A1=`IF($A32="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D32`: A1=`IF($A32="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E32`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F32`: A1=`IF($A32="","",
 _xlfn.LET(
  _xlpm.d,$A32,
  _xlpm.ti,$B32, _xlpm.eo,$E32, _xlpm.bs,$C32, _xlpm.be,$D32,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K32)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G32`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J32`: A1=`IF(OR($A32="",$G32="",$I32=""),"",
  _xlfn.LET(
    _xlpm.st,$G32,_xlpm.en,$I32,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N32`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A33`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A32),FIND("]",CELL("filename",A32))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44345)
- `C33`: A1=`IF($A33="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D33`: A1=`IF($A33="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E33`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F33`: A1=`IF($A33="","",
 _xlfn.LET(
  _xlpm.d,$A33,
  _xlpm.ti,$B33, _xlpm.eo,$E33, _xlpm.bs,$C33, _xlpm.be,$D33,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K33)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G33`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J33`: A1=`IF(OR($A33="",$G33="",$I33=""),"",
  _xlfn.LET(
    _xlpm.st,$G33,_xlpm.en,$I33,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N33`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `D34`: A1=`SUMPRODUCT(N($F$3:$F$33))*24`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `G34`: A1=`IF(COUNTA($F$3:$F$33)=0,"",
 SUMPRODUCT(
   IF($F$3:$F$33="",
      0,
      IF(ISNUMBER($F$3:$F$33),
         $F$3:$F$33,
         IFERROR(TIMEVALUE($F$3:$F$33),0)
      )
   )
 )*24
)`; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `N34`: A1=`SUM(N3:N30)`; R1C1=`(not available in source)` (Column header: 0)
- `P36`: A1=`$K$2`; R1C1=`(not available in source)` (Column header: TOTAL)
- `R36`: A1=`$M$2`; R1C1=`(not available in source)` (Column header: TOTAL)
- `B37`: A1=`IF(D37="","",
 _xlfn.LET(
  _xlpm.rng,$F$3:$F$33,
  _xlpm.vals,IF(_xlpm.rng="","",IF(ISNUMBER(_xlpm.rng),_xlpm.rng,IFERROR(TIMEVALUE(_xlpm.rng),0))),
  _xlpm.totalH,SUM(_xlpm.vals)*24,
  _xlpm.hpd,IF(ISTEXT(staffsettings!$V$2),
         IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
         IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)),
  _xlpm.shortDays,IF(OR(_xlpm.totalH=0,_xlpm.hpd<=0),0,_xlpm.totalH/_xlpm.hpd),
  MAX(0,D37-_xlpm.shortDays)
 )
)`; R1C1=`(not available in source)` (Column header: PM)
- `C37`: A1=`companysettings!$N$35`; R1C1=`(not available in source)` (Column header: PY)
- `D37`: A1=`IF(COUNTA($A$3:$A$33)=0,"",
 _xlfn.LET(
  _xlpm.d,$A$3:$A$33,
  _xlpm.w,IF(_xlpm.d="",0,WEEKDAY(_xlpm.d,2)),
  _xlpm.mon,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Mon",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.tue,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Tue",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.wed,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Wed",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.thu,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Thu",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.fri,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Fri",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.sat,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sat",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.sun,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sun",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.off,(_xlpm.w=1)*_xlpm.mon+(_xlpm.w=2)*_xlpm.tue+(_xlpm.w=3)*_xlpm.wed+(_xlpm.w=4)*_xlpm.thu+(_xlpm.w=5)*_xlpm.fri+(_xlpm.w=6)*_xlpm.sat+(_xlpm.w=7)*_xlpm.sun,
  _xlpm.obs,--(UPPER(TRIM(_xlfn.XLOOKUP("Observe Public Holidays",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.e,holidays!$E$2:$E$300,
  _xlpm.eTxt,IF(_xlpm.e="","",IFERROR(TEXT(_xlpm.e,"yyyy-mm-dd"),IFERROR(TEXT(DATEVALUE(_xlpm.e),"yyyy-mm-dd"),""))),
  _xlpm.dTxt,IF(_xlpm.d="","",TEXT(_xlpm.d,"yyyy-mm-dd")),
  _xlpm.ph,IF(_xlpm.obs,--ISNUMBER(_xlfn.XMATCH(_xlpm.dTxt,_xlpm.eTxt,0)),0),
  SUMPRODUCT((_xlpm.d<>"")*(_xlpm.off=0)*(_xlpm.ph=0))
 ))`; R1C1=`(not available in source)` (Column header: FMA)
- `E37`: A1=`companysettings!$N$39`; R1C1=`(not available in source)` (Column header: FYA)
- `J37`: A1=`IFERROR(
  J38 /
  IF(ISTEXT(staffsettings!$V$2),
     IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
     IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
  ),
0)`; R1C1=`(not available in source)` (Column header: OT)
- `O37`: A1=`staffsettings!I6`; R1C1=`(not available in source)` (Column header: Attandance)
- `P37`: A1=`staffsettings!L6`; R1C1=`(not available in source)` (Column header: ATT)
- `Q37`: A1=`staffsettings!S21`; R1C1=`(not available in source)` (Column header: Pay Structure)
- `R37`: A1=`staffsettings!T21`; R1C1=`(not available in source)` (Column header: PS)
- `B38`: A1=`_xlfn.LET(
 _xlpm.rng,$F$3:$F$33,
 _xlpm.vals,IF(_xlpm.rng="","",IF(ISNUMBER(_xlpm.rng),_xlpm.rng,IFERROR(TIMEVALUE(_xlpm.rng),0))),
 _xlpm.totalH,SUM(_xlpm.vals)*24,
 IF(_xlpm.totalH=0,"",_xlpm.totalH)
)`; R1C1=`(not available in source)` (Column header: 11)
- `C38`: A1=`companysettings!$N$36`; R1C1=`(not available in source)` (Column header: #REF!)
- `D38`: A1=`IF(D37="","",
 _xlfn.LET(
  _xlpm.h,IF(ISTEXT(staffsettings!$V$2),
        IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
        IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
     ),
  D37*_xlpm.h
 ))`; R1C1=`(not available in source)` (Column header: 22)
- `E38`: A1=`companysettings!$N$40`; R1C1=`(not available in source)` (Column header: #REF!)
- `J38`: A1=`IFERROR(SUM(J3:J33),0)`; R1C1=`(not available in source)` (Column header: 2.2499999999999978)
- `O38`: A1=`staffsettings!I7`; R1C1=`(not available in source)` (Column header: Annual Leave)
- `P38`: A1=`staffsettings!L7`; R1C1=`(not available in source)` (Column header: AL)
- `Q38`: A1=`staffsettings!S22`; R1C1=`(not available in source)` (Column header: Work Days)
- `R38`: A1=`staffsettings!T22`; R1C1=`(not available in source)` (Column header: WD)
- `F39`: A1=`IF($F$49<=0,"",
  IF(N(staffsettings!$R$3)>0, staffsettings!$R$3/$F$49,
     IF(N(staffsettings!$R$4)>0, staffsettings!$R$4, "")
  )
)`; R1C1=`(not available in source)` (Column header: FULL)
- `J39`: A1=`IFERROR(_xlfn.LET(
  _xlpm.z,UPPER(TRIM(companysettings!$Z$8)),
  _xlpm.basis,IF(LEFT(_xlpm.z,3)="F37",$F$49,
        IF(LEFT(_xlpm.z,6)="ACTUAL",$F$49,
           IFERROR(VALUE(_xlpm.z),26))),
  _xlpm.h,IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
     IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)),
  _xlpm.sal,N(staffsettings!$R$3),
  _xlpm.dr,N(staffsettings!$R$4),
  _xlpm.hr,N(staffsettings!$R$5),
  _xlpm.dly,IF(_xlpm.sal>0, _xlpm.sal/_xlpm.basis,
       IF(_xlpm.dr>0, _xlpm.dr,
          IF(AND(_xlpm.hr>0,_xlpm.h>0), _xlpm.hr*_xlpm.h, ""))),
  _xlpm.dly
),"")`; R1C1=`(not available in source)` (Column header: 17.999999999999982)
- `O39`: A1=`staffsettings!I8`; R1C1=`(not available in source)` (Column header: Full Day)
- `P39`: A1=`staffsettings!L8`; R1C1=`(not available in source)` (Column header: FD)
- `Q39`: A1=`staffsettings!S23`; R1C1=`(not available in source)` (Column header: Work Days - Indoor)
- `R39`: A1=`staffsettings!T23`; R1C1=`(not available in source)` (Column header: WDI)
- `U39`: A1=`SUM(U18:U22)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `F40`: A1=`IFERROR(
 IF(N(staffsettings!$R$3)>0,
    IF($F$50>0, staffsettings!$R$3/$F$50, ""),
    IF(N(staffsettings!$R$5)>0,
       staffsettings!$R$5,
       IF(AND(N(staffsettings!$R$4)>0,
              IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
                 IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2))>0),
          staffsettings!$R$4/
            IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
               IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)),
          ""
       )
    )
 ),
"")`; R1C1=`(not available in source)` (Column header: 81.818181818181813)
- `J40`: A1=`IFERROR(_xlfn.LET(
  _xlpm.z,UPPER(TRIM(companysettings!$Z$8)),
  _xlpm.h,IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)),
  _xlpm.basis,IF(LEFT(_xlpm.z,3)="F37",$F$49,IF(LEFT(_xlpm.z,6)="ACTUAL",$F$49,IFERROR(VALUE(_xlpm.z),26))),
  _xlpm.sal,N(staffsettings!$R$3),
  _xlpm.dr,N(staffsettings!$R$4),
  _xlpm.hr,N(staffsettings!$R$5),
  _xlpm.dly,IF(_xlpm.sal>0,_xlpm.sal/_xlpm.basis,IF(_xlpm.dr>0,_xlpm.dr,IF(AND(_xlpm.hr>0,_xlpm.h>0),_xlpm.hr*_xlpm.h,""))),
  IF(_xlpm.h<=0,"",IF(_xlpm.dly="","",_xlpm.dly/_xlpm.h))
),"")`; R1C1=`(not available in source)` (Column header: 69.230769230769226)
- `O40`: A1=`staffsettings!I9`; R1C1=`(not available in source)` (Column header: Half Day)
- `P40`: A1=`staffsettings!L9`; R1C1=`(not available in source)` (Column header: HD)
- `Q40`: A1=`staffsettings!S24`; R1C1=`(not available in source)` (Column header: 0)
- `R40`: A1=`staffsettings!T24`; R1C1=`(not available in source)` (Column header: 0)
- `F41`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,
_xlpm.obs,--(UPPER(TRIM(_xlfn.XLOOKUP("Observe Public Holidays",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No")))="YES"),
_xlpm.elist,IFERROR(_xlfn._xlws.FILTER(holidays!$E$2:$E$30,holidays!$E$2:$E$30<>""),""),
_xlpm.dTxt,TEXT(_xlpm.d,"yyyy-mm-dd"),
_xlpm.eTxt,IF(_xlpm.elist="","",TEXT(_xlpm.elist,"yyyy-mm-dd")),
IF(_xlpm.obs,SUMPRODUCT(($A$3:$A$33<>"")*ISNUMBER(MATCH(_xlpm.dTxt,_xlpm.eTxt,0))),0))`; R1C1=`(not available in source)` (Column header: 10.227272727272727)
- `J41`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,
_xlpm.obs,--(UPPER(TRIM(_xlfn.XLOOKUP("Observe Public Holidays",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No")))="YES"),
_xlpm.elist,IFERROR(_xlfn._xlws.FILTER(holidays!$E$2:$E$30,holidays!$E$2:$E$30<>""),""),
_xlpm.dTxt,TEXT(_xlpm.d,"yyyy-mm-dd"),
_xlpm.eTxt,IF(_xlpm.elist="","",TEXT(_xlpm.elist,"yyyy-mm-dd")),
IF(_xlpm.obs,SUMPRODUCT(($A$3:$A$33<>"")*ISNUMBER(MATCH(_xlpm.dTxt,_xlpm.eTxt,0))),0))`; R1C1=`(not available in source)` (Column header: 8.6538461538461533)
- `O41`: A1=`staffsettings!I10`; R1C1=`(not available in source)` (Column header: Present)
- `P41`: A1=`staffsettings!L10`; R1C1=`(not available in source)` (Column header: PR)
- `T41`: A1=`U11`; R1C1=`(not available in source)` (Column header: OVERTIME  EARNINGS)
- `U41`: A1=`F39`; R1C1=`(not available in source)` (Column header: 17.999999999999982)
- `F42`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,_xlpm.w,IF($A$3:$A$33="",0,WEEKDAY($A$3:$A$33,2)),
_xlpm.mon,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Mon",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.tue,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Tue",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.wed,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Wed",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.thu,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Thu",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.fri,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Fri",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sat,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sat",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sun,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sun",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
SUMPRODUCT(($A$3:$A$33<>"")*((_xlpm.w=1)*_xlpm.mon+(_xlpm.w=2)*_xlpm.tue+(_xlpm.w=3)*_xlpm.wed+(_xlpm.w=4)*_xlpm.thu+(_xlpm.w=5)*_xlpm.fri+(_xlpm.w=6)*_xlpm.sat+(_xlpm.w=7)*_xlpm.sun)))`; R1C1=`(not available in source)` (Column header: 0)
- `J42`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,_xlpm.w,IF($A$3:$A$33="",0,WEEKDAY($A$3:$A$33,2)),
_xlpm.mon,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Mon",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.tue,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Tue",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.wed,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Wed",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.thu,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Thu",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.fri,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Fri",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sat,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sat",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sun,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sun",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
SUMPRODUCT(($A$3:$A$33<>"")*((_xlpm.w=1)*_xlpm.mon+(_xlpm.w=2)*_xlpm.tue+(_xlpm.w=3)*_xlpm.wed+(_xlpm.w=4)*_xlpm.thu+(_xlpm.w=5)*_xlpm.fri+(_xlpm.w=6)*_xlpm.sat+(_xlpm.w=7)*_xlpm.sun)))`; R1C1=`(not available in source)` (Column header: 0)
- `T42`: A1=`U12`; R1C1=`(not available in source)` (Column header: 4)
- `U42`: A1=`F40`; R1C1=`(not available in source)` (Column header: 81.818181818181813)
- `V42`: A1=`T42*U42`; R1C1=`(not available in source)` (Column header: 126)
- `F43`: A1=`IFERROR(IF(N(staffsettings!$R$8)>0,N(staffsettings!$R$8),""),"")`; R1C1=`(not available in source)` (Column header: 9)
- `J43`: A1=`IFERROR(IF(N(staffsettings!$R$8)>0,N(staffsettings!$R$8),""),"")`; R1C1=`(not available in source)` (Column header: 9)
- `P43`: A1=`$L$2`; R1C1=`(not available in source)` (Column header: SL)
- `T43`: A1=``; R1C1=`(not available in source)` (Column header: 32)
- `U43`: A1=`F43`; R1C1=`(not available in source)` (Column header: 10.227272727272727)
- `F44`: A1=`IFERROR(IF(N(staffsettings!$R$9)>0,N(staffsettings!$R$9),""),"")`; R1C1=`(not available in source)` (Column header: 70)
- `J44`: A1=`IFERROR(IF(N(staffsettings!$R$9)>0,N(staffsettings!$R$9),""),"")`; R1C1=`(not available in source)` (Column header: 70)
- `O44`: A1=`staffsettings!AM2`; R1C1=`(not available in source)` (Column header: Overtime)
- `P44`: A1=`staffsettings!AN2`; R1C1=`(not available in source)` (Column header: OT)
- `T44`: A1=``; R1C1=`(not available in source)` (Column header: 58)
- `U44`: A1=`F44`; R1C1=`(not available in source)` (Column header: 70)
- `V44`: A1=``; R1C1=`(not available in source)` (Column header: 327.27272727272725)
- `F45`: A1=`IF(COUNTA($A$3:$A$33)=0,"",24*SUMIFS($F$3:$F$33,$M$3:$M$33,"WD"))`; R1C1=`(not available in source)` (Column header: 8.75)
- `J45`: A1=`SUM($J$3:$J$33)`; R1C1=`(not available in source)` (Column header: 8.75)
- `O45`: A1=`staffsettings!AM3`; R1C1=`(not available in source)` (Column header: Default)
- `P45`: A1=`staffsettings!AN3`; R1C1=`(not available in source)` (Column header: N)
- `V45`: A1=`SUM(V41:V44)`; R1C1=`(not available in source)` (Column header: 4060)
- `F46`: A1=`IF(COUNTA($A$3:$A$33)=0,"",24*SUMIFS($F$3:$F$33,$M$3:$M$33,"WDI"))`; R1C1=`(not available in source)` (Column header: 8)
- `J46`: A1=`SUM($U$18:$U$30)`; R1C1=`(not available in source)` (Column header: 17.999999999999982)
- `O46`: A1=`staffsettings!AM4`; R1C1=`(not available in source)` (Column header: Rest Day)
- `P46`: A1=`staffsettings!AN4`; R1C1=`(not available in source)` (Column header: RD)
- `O47`: A1=`staffsettings!AM5`; R1C1=`(not available in source)` (Column header: Public Holiday)
- `P47`: A1=`staffsettings!AN5`; R1C1=`(not available in source)` (Column header: P)
- `V47`: A1=`F50*F40`; R1C1=`(not available in source)` (Column header: 4387.272727272727)
- `O48`: A1=`staffsettings!AM6`; R1C1=`(not available in source)` (Column header: PH on Rest Day)
- `P48`: A1=`staffsettings!AN6`; R1C1=`(not available in source)` (Column header: PR)
- `V48`: A1=` $F$50 - _xlfn.LET(
 _xlpm.hs,$F$3:$F$33,
 _xlpm.hsD,IF(_xlpm.hs="",
        0,
        IF(ISNUMBER(_xlpm.hs),
           MOD(_xlpm.hs,1),
           IFERROR(MOD(TIMEVALUE(_xlpm.hs),1),0)
        )
     ),
 24*SUM(_xlpm.hsD)
)`; R1C1=`(not available in source)` (Column header: 1800)
- `F49`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,_xlpm.w,IF($A$3:$A$33="",0,WEEKDAY($A$3:$A$33,2)),
_xlpm.mon,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Mon",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.tue,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Tue",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.wed,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Wed",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.thu,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Thu",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.fri,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Fri",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sat,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sat",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sun,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sun",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.off,(_xlpm.w=1)*_xlpm.mon+(_xlpm.w=2)*_xlpm.tue+(_xlpm.w=3)*_xlpm.wed+(_xlpm.w=4)*_xlpm.thu+(_xlpm.w=5)*_xlpm.fri+(_xlpm.w=6)*_xlpm.sat+(_xlpm.w=7)*_xlpm.sun,
_xlpm.obs,--(UPPER(TRIM(_xlfn.XLOOKUP("Observe Public Holidays",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.e,holidays!$E$2:$E$30,
_xlpm.eTxt,IF(_xlpm.e="", "", IFERROR(TEXT(_xlpm.e,"yyyy-mm-dd"), IFERROR(TEXT(DATEVALUE(_xlpm.e),"yyyy-mm-dd"),""))),
_xlpm.dTxt,IF(_xlpm.d="", "", TEXT(_xlpm.d,"yyyy-mm-dd")),
_xlpm.ph,IF(_xlpm.obs, --ISNUMBER(_xlfn.XMATCH(_xlpm.dTxt,_xlpm.eTxt,0)), 0),
SUMPRODUCT(($A$3:$A$33<>"")*(_xlpm.off=0)*(_xlpm.ph=0)))`; R1C1=`(not available in source)` (Column header: 80)
- `V49`: A1=` $F$50 - _xlfn.LET(
 _xlpm.hs,$F$3:$F$33,
 _xlpm.hsD,IF(_xlpm.hs="",
        0,
        IF(ISNUMBER(_xlpm.hs),
           MOD(_xlpm.hs,1),
           IFERROR(MOD(TIMEVALUE(_xlpm.hs),1),0)
        )
     ),
 24*SUM(_xlpm.hsD)
)`; R1C1=`(not available in source)` (Column header: 88)
- `F50`: A1=`IF($F$49<=0,"",
 $F$49 *
 IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
    IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2))
)`; R1C1=`(not available in source)` (Column header: 22)

### Data Validations
- `M3:M33`: type=list operator=None formula1=`PayStructureList` formula2=`None` (Column header: PS)
- `K3:K33`: type=list operator=None formula1=`AttendanceList` formula2=`None` (Column header: ATT)
- `L3:L33`: type=list operator=None formula1=`OTTypeList` formula2=`None` (Column header: OT)

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: 04

### Summary
- **Used range**: `A1:Y50`
- **Excel Tables**: None

### Formulas
- `T2`: A1=`companysettings!$B$3`; R1C1=`(not available in source)` (Row header: TOTAL)
- `Y2`: A1=`UPPER("PAYSLIP - "&TEXT(DATE(companysettings!$N$2,VALUE(MID(CELL("filename",A1),FIND("]",CELL("filename",A1))+1,2)),1),"mmmm yyyy"))`; R1C1=`(not available in source)` (Row header: SA0019087-A)
- `A3`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A2),FIND("]",CELL("filename",A2))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: DATE)
- `C3`: A1=`IF($A3="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: BS)
- `D3`: A1=`IF($A3="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: BE)
- `F3`: A1=`IF($A3="","",
 _xlfn.LET(
  _xlpm.d,$A3,
  _xlpm.ti,$B3, _xlpm.eo,$E3, _xlpm.bs,$C3, _xlpm.be,$D3,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K3)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: HS)
- `G3`: A1=`IF($A3="","",IF($H3<>"",$H3,IF($E3<>"",$E3,"")))`; R1C1=`(not available in source)` (Column header: OT/I)
- `J3`: A1=`IF(OR($A3="",$G3="",$I3=""),"",
  _xlfn.LET(
    _xlpm.st,$G3,_xlpm.en,$I3,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: OT/H)
- `N3`: A1=`F3`; R1C1=`(not available in source)` (Column header: Note)
- `A4`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A3),FIND("]",CELL("filename",A3))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44286)
- `B4`: A1=`$B$3`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C4`: A1=`IF($A4="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D4`: A1=`IF($A4="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E4`: A1=`$E$3`; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F4`: A1=`IF($A4="","",
 _xlfn.LET(
  _xlpm.d,$A4,
  _xlpm.ti,$B4, _xlpm.eo,$E4, _xlpm.bs,$C4, _xlpm.be,$D4,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K4)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G4`: A1=`IF($A4="","",IF($H4<>"",$H4,IF($E4<>"",$E4,"")))`; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J4`: A1=`IF(OR($A4="",$G4="",$I4=""),"",
  _xlfn.LET(
    _xlpm.st,$G4,_xlpm.en,$I4,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N4`: A1=`F4`; R1C1=`(not available in source)` (Column header: 0)
- `A5`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A4),FIND("]",CELL("filename",A4))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44287)
- `B5`: A1=`$B$3`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C5`: A1=`IF($A5="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D5`: A1=`IF($A5="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E5`: A1=`$E$3`; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F5`: A1=`IF($A5="","",
 _xlfn.LET(
  _xlpm.d,$A5,
  _xlpm.ti,$B5, _xlpm.eo,$E5, _xlpm.bs,$C5, _xlpm.be,$D5,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K5)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G5`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J5`: A1=`IF(OR($A5="",$G5="",$I5=""),"",
  _xlfn.LET(
    _xlpm.st,$G5,_xlpm.en,$I5,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N5`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `T5`: A1=`Line1()&CHAR(10)&Line2()&CHAR(10)&SocialLine()`; R1C1=`(not available in source)` (Column header: SA0019087-A)
- `A6`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A5),FIND("]",CELL("filename",A5))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44288)
- `B6`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C6`: A1=`IF($A6="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D6`: A1=`IF($A6="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E6`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F6`: A1=`IF($A6="","",
 _xlfn.LET(
  _xlpm.d,$A6,
  _xlpm.ti,$B6, _xlpm.eo,$E6, _xlpm.bs,$C6, _xlpm.be,$D6,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K6)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G6`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J6`: A1=`IF(OR($A6="",$G6="",$I6=""),"",
  _xlfn.LET(
    _xlpm.st,$G6,_xlpm.en,$I6,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N6`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A7`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A6),FIND("]",CELL("filename",A6))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44289)
- `B7`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C7`: A1=`IF($A7="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D7`: A1=`IF($A7="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E7`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F7`: A1=`IF($A7="","",
 _xlfn.LET(
  _xlpm.d,$A7,
  _xlpm.ti,$B7, _xlpm.eo,$E7, _xlpm.bs,$C7, _xlpm.be,$D7,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K7)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G7`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J7`: A1=`IF(OR($A7="",$G7="",$I7=""),"",
  _xlfn.LET(
    _xlpm.st,$G7,_xlpm.en,$I7,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N7`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A8`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A7),FIND("]",CELL("filename",A7))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44290)
- `B8`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C8`: A1=`IF($A8="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D8`: A1=`IF($A8="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E8`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F8`: A1=`IF($A8="","",
 _xlfn.LET(
  _xlpm.d,$A8,
  _xlpm.ti,$B8, _xlpm.eo,$E8, _xlpm.bs,$C8, _xlpm.be,$D8,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K8)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G8`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J8`: A1=`IF(OR($A8="",$G8="",$I8=""),"",
  _xlfn.LET(
    _xlpm.st,$G8,_xlpm.en,$I8,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N8`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A9`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A8),FIND("]",CELL("filename",A8))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44291)
- `B9`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C9`: A1=`IF($A9="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D9`: A1=`IF($A9="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E9`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F9`: A1=`IF($A9="","",
 _xlfn.LET(
  _xlpm.d,$A9,
  _xlpm.ti,$B9, _xlpm.eo,$E9, _xlpm.bs,$C9, _xlpm.be,$D9,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K9)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G9`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J9`: A1=`IF(OR($A9="",$G9="",$I9=""),"",
  _xlfn.LET(
    _xlpm.st,$G9,_xlpm.en,$I9,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N9`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A10`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A9),FIND("]",CELL("filename",A9))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44292)
- `B10`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C10`: A1=`IF($A10="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D10`: A1=`IF($A10="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E10`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F10`: A1=`IF($A10="","",
 _xlfn.LET(
  _xlpm.d,$A10,
  _xlpm.ti,$B10, _xlpm.eo,$E10, _xlpm.bs,$C10, _xlpm.be,$D10,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K10)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G10`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J10`: A1=`IF(OR($A10="",$G10="",$I10=""),"",
  _xlfn.LET(
    _xlpm.st,$G10,_xlpm.en,$I10,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N10`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A11`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A10),FIND("]",CELL("filename",A10))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44293)
- `B11`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C11`: A1=`IF($A11="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D11`: A1=`IF($A11="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E11`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F11`: A1=`IF($A11="","",
 _xlfn.LET(
  _xlpm.d,$A11,
  _xlpm.ti,$B11, _xlpm.eo,$E11, _xlpm.bs,$C11, _xlpm.be,$D11,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K11)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G11`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J11`: A1=`IF(OR($A11="",$G11="",$I11=""),"",
  _xlfn.LET(
    _xlpm.st,$G11,_xlpm.en,$I11,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N11`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `T11`: A1=`IF(COUNTA($M$3:$M$33)=0,"",
 _xlfn._xlws.FILTER(
  staffsettings!$S$2:$S$20,
  COUNTIF($M$3:$M$33, staffsettings!$T$2:$T$20)>0
 )
)`; R1C1=`(not available in source)` (Column header: BASIC)
- `U11`: A1=`IF(T11="","",
 _xlfn.LET(
  _xlpm.h,
   IF(ISTEXT(staffsettings!$V$2),
      IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
      IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
   ),

  _xlpm.wdH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WD")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.wdiH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WDI")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.label, T11,

  _xlpm.val,
   IF(_xlpm.label="Work Hours",_xlpm.wdH,
    IF(_xlpm.label="Work Days",IF(_xlpm.wdH="","",ROUND(_xlpm.wdH/_xlpm.h,2)),
     IF(_xlpm.label="Work Hours - Indoor",_xlpm.wdiH,
      IF(_xlpm.label="Work Days - Indoor",IF(_xlpm.wdiH="","",ROUND(_xlpm.wdiH/_xlpm.h,2)),"")
     )
    )
   ),

  IF(OR(_xlpm.val="",_xlpm.val=0),"",_xlpm.val)
 )
)`; R1C1=`(not available in source)` (Row header: Work Days)
- `A12`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A11),FIND("]",CELL("filename",A11))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44294)
- `B12`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C12`: A1=`IF($A12="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D12`: A1=`IF($A12="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E12`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F12`: A1=`IF($A12="","",
 _xlfn.LET(
  _xlpm.d,$A12,
  _xlpm.ti,$B12, _xlpm.eo,$E12, _xlpm.bs,$C12, _xlpm.be,$D12,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K12)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G12`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J12`: A1=`IF(OR($A12="",$G12="",$I12=""),"",
  _xlfn.LET(
    _xlpm.st,$G12,_xlpm.en,$I12,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N12`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U12`: A1=`IF(T12="","",
 _xlfn.LET(
  _xlpm.h,
   IF(ISTEXT(staffsettings!$V$2),
      IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
      IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
   ),

  _xlpm.wdH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WD")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.wdiH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WDI")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.label, T12,

  _xlpm.val,
   IF(_xlpm.label="Work Hours",_xlpm.wdH,
    IF(_xlpm.label="Work Days",IF(_xlpm.wdH="","",ROUND(_xlpm.wdH/_xlpm.h,2)),
     IF(_xlpm.label="Work Hours - Indoor",_xlpm.wdiH,
      IF(_xlpm.label="Work Days - Indoor",IF(_xlpm.wdiH="","",ROUND(_xlpm.wdiH/_xlpm.h,2)),"")
     )
    )
   ),

  IF(OR(_xlpm.val="",_xlpm.val=0),"",_xlpm.val)
 )
)`; R1C1=`(not available in source)` (Column header: 4.25)
- `V12`: A1=`IF(U12="","",
 _xlfn.LET(
   _xlpm.lbl, T12,
   _xlpm.ps, IFERROR(
         INDEX(staffsettings!$T$2:$T$20,
               MATCH(_xlpm.lbl,staffsettings!$S$2:$S$20,0)
         ),
         ""
       ),
   _xlpm.rate, IF(_xlpm.ps="WD",$F$40,
           IF(_xlpm.ps="WDI",$F$44,0)
   ),
   U12*_xlpm.rate
 )
)`; R1C1=`(not available in source)` (Row header: 34)
- `A13`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A12),FIND("]",CELL("filename",A12))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44295)
- `B13`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C13`: A1=`IF($A13="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D13`: A1=`IF($A13="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E13`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F13`: A1=`IF($A13="","",
 _xlfn.LET(
  _xlpm.d,$A13,
  _xlpm.ti,$B13, _xlpm.eo,$E13, _xlpm.bs,$C13, _xlpm.be,$D13,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K13)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G13`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J13`: A1=`IF(OR($A13="",$G13="",$I13=""),"",
  _xlfn.LET(
    _xlpm.st,$G13,_xlpm.en,$I13,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N13`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U13`: A1=`IF(T13="","",
 _xlfn.LET(
  _xlpm.h,
   IF(ISTEXT(staffsettings!$V$2),
      IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
      IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
   ),

  _xlpm.wdH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WD")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.wdiH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WDI")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.label, T13,

  _xlpm.val,
   IF(_xlpm.label="Work Hours",_xlpm.wdH,
    IF(_xlpm.label="Work Days",IF(_xlpm.wdH="","",ROUND(_xlpm.wdH/_xlpm.h,2)),
     IF(_xlpm.label="Work Hours - Indoor",_xlpm.wdiH,
      IF(_xlpm.label="Work Days - Indoor",IF(_xlpm.wdiH="","",ROUND(_xlpm.wdiH/_xlpm.h,2)),"")
     )
    )
   ),

  IF(OR(_xlpm.val="",_xlpm.val=0),"",_xlpm.val)
 )
)`; R1C1=`(not available in source)` (Column header: 34)
- `A14`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A13),FIND("]",CELL("filename",A13))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44296)
- `B14`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C14`: A1=`IF($A14="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D14`: A1=`IF($A14="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E14`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F14`: A1=`IF($A14="","",
 _xlfn.LET(
  _xlpm.d,$A14,
  _xlpm.ti,$B14, _xlpm.eo,$E14, _xlpm.bs,$C14, _xlpm.be,$D14,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K14)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G14`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J14`: A1=`IF(OR($A14="",$G14="",$I14=""),"",
  _xlfn.LET(
    _xlpm.st,$G14,_xlpm.en,$I14,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N14`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U14`: A1=`IF(T14="","",
 _xlfn.LET(
  _xlpm.h,
   IF(ISTEXT(staffsettings!$V$2),
      IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
      IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
   ),

  _xlpm.wdH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WD")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.wdiH,
   IF(_xlpm.h<=0,"",
     ROUND(SUMPRODUCT(
       ($A$3:$A$33<>"")*($M$3:$M$33="WDI")*
       MAX(0,
         ($E$3:$E$33-$B$3:$B$33)-
         IF(
           ($C$3:$D$33<>"")*(($E$3:$E$33>$C$3:$C$33)),
           MAX(0,MIN($E$3:$E$33,$D$3:$D$33)-MAX($B$3:$B$3,$C$3:$C$33)),
           0
         )
       )
     )*24,2)
   ),

  _xlpm.label, T14,

  _xlpm.val,
   IF(_xlpm.label="Work Hours",_xlpm.wdH,
    IF(_xlpm.label="Work Days",IF(_xlpm.wdH="","",ROUND(_xlpm.wdH/_xlpm.h,2)),
     IF(_xlpm.label="Work Hours - Indoor",_xlpm.wdiH,
      IF(_xlpm.label="Work Days - Indoor",IF(_xlpm.wdiH="","",ROUND(_xlpm.wdiH/_xlpm.h,2)),"")
     )
    )
   ),

  IF(OR(_xlpm.val="",_xlpm.val=0),"",_xlpm.val)
 )
)`; R1C1=`(not available in source)` (Column header: 59.5)
- `V14`: A1=`IF(U14="","",
 _xlfn.LET(
   _xlpm.lbl, T14,
   _xlpm.ps, IFERROR(
         INDEX(staffsettings!$T$2:$T$20,
               MATCH(_xlpm.lbl,staffsettings!$S$2:$S$20,0)
         ),
         ""
       ),
   _xlpm.rate, IF(_xlpm.ps="WD",$F$40,
           IF(_xlpm.ps="WDI",$F$44,0)
   ),
   U14*_xlpm.rate
 )
)`; R1C1=`(not available in source)` (Column header: 347.72727272727269)
- `A15`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A14),FIND("]",CELL("filename",A14))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44297)
- `B15`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C15`: A1=`IF($A15="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D15`: A1=`IF($A15="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E15`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F15`: A1=`IF($A15="","",
 _xlfn.LET(
  _xlpm.d,$A15,
  _xlpm.ti,$B15, _xlpm.eo,$E15, _xlpm.bs,$C15, _xlpm.be,$D15,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K15)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G15`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J15`: A1=`IF(OR($A15="",$G15="",$I15=""),"",
  _xlfn.LET(
    _xlpm.st,$G15,_xlpm.en,$I15,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N15`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `V15`: A1=`IF(AND($U$11="",$U$13=""),"",
 (IF($U$11="",0,$U$12*$F$40)) +
 (IF($U$13="",0,$U$14*$F$44))
)`; R1C1=`(not available in source)` (Column header: 4165)
- `A16`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A15),FIND("]",CELL("filename",A15))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44298)
- `B16`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `C16`: A1=`IF($A16="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D16`: A1=`IF($A16="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E16`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F16`: A1=`IF($A16="","",
 _xlfn.LET(
  _xlpm.d,$A16,
  _xlpm.ti,$B16, _xlpm.eo,$E16, _xlpm.bs,$C16, _xlpm.be,$D16,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K16)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G16`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J16`: A1=`IF(OR($A16="",$G16="",$I16=""),"",
  _xlfn.LET(
    _xlpm.st,$G16,_xlpm.en,$I16,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N16`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A17`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A16),FIND("]",CELL("filename",A16))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44299)
- `C17`: A1=`IF($A17="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D17`: A1=`IF($A17="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E17`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F17`: A1=`IF($A17="","",
 _xlfn.LET(
  _xlpm.d,$A17,
  _xlpm.ti,$B17, _xlpm.eo,$E17, _xlpm.bs,$C17, _xlpm.be,$D17,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K17)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G17`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J17`: A1=`IF(OR($A17="",$G17="",$I17=""),"",
  _xlfn.LET(
    _xlpm.st,$G17,_xlpm.en,$I17,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N17`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A18`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A17),FIND("]",CELL("filename",A17))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44300)
- `C18`: A1=`IF($A18="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D18`: A1=`IF($A18="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E18`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F18`: A1=`IF($A18="","",
 _xlfn.LET(
  _xlpm.d,$A18,
  _xlpm.ti,$B18, _xlpm.eo,$E18, _xlpm.bs,$C18, _xlpm.be,$D18,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K18)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G18`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J18`: A1=`IF(OR($A18="",$G18="",$I18=""),"",
  _xlfn.LET(
    _xlpm.st,$G18,_xlpm.en,$I18,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N18`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `T18`: A1=`IF(COUNTA($L$3:$L$33)=0,"",
 _xlfn.LET(
   _xlpm.codes,_xlfn.UNIQUE(_xlfn._xlws.FILTER($L$3:$L$33,$L$3:$L$33<>"")),
   _xlpm.idx,MATCH(_xlpm.codes,staffsettings!$AN$2:$AN$6,0),
   _xlpm.names,INDEX(staffsettings!$AM$2:$AM$6,_xlpm.idx),
   _xlpm.prior,INDEX(staffsettings!$AL$2:$AL$6,_xlpm.idx),
   _xlpm.sorted,_xlfn._xlws.SORT(CHOOSE({1,2},_xlpm.names,_xlpm.prior),2,TRUE),
   INDEX(_xlpm.sorted,,1)
 )
)`; R1C1=`(not available in source)` (Column header: OVERTIME)
- `U18`: A1=`IF(T18="","",
 _xlfn.LET(
   _xlpm.nm,T18,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: Hrs)
- `V18`: A1=`IF(T18="","",
 _xlfn.LET(
  _xlpm.nm,T18,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 4512.727272727273)
- `A19`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A18),FIND("]",CELL("filename",A18))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44301)
- `C19`: A1=`IF($A19="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D19`: A1=`IF($A19="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E19`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F19`: A1=`IF($A19="","",
 _xlfn.LET(
  _xlpm.d,$A19,
  _xlpm.ti,$B19, _xlpm.eo,$E19, _xlpm.bs,$C19, _xlpm.be,$D19,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K19)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G19`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J19`: A1=`IF(OR($A19="",$G19="",$I19=""),"",
  _xlfn.LET(
    _xlpm.st,$G19,_xlpm.en,$I19,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N19`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `U19`: A1=`IF(T19="","",
 _xlfn.LET(
   _xlpm.nm,T19,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `V19`: A1=`IF(T19="","",
 _xlfn.LET(
  _xlpm.nm,T19,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 51.24)
- `A20`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A19),FIND("]",CELL("filename",A19))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44302)
- `C20`: A1=`IF($A20="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D20`: A1=`IF($A20="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E20`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F20`: A1=`IF($A20="","",
 _xlfn.LET(
  _xlpm.d,$A20,
  _xlpm.ti,$B20, _xlpm.eo,$E20, _xlpm.bs,$C20, _xlpm.be,$D20,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K20)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G20`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J20`: A1=`IF(OR($A20="",$G20="",$I20=""),"",
  _xlfn.LET(
    _xlpm.st,$G20,_xlpm.en,$I20,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N20`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `U20`: A1=`IF(T20="","",
 _xlfn.LET(
   _xlpm.nm,T20,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `V20`: A1=`IF(T20="","",
 _xlfn.LET(
  _xlpm.nm,T20,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 63)
- `A21`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A20),FIND("]",CELL("filename",A20))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44303)
- `C21`: A1=`IF($A21="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D21`: A1=`IF($A21="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E21`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F21`: A1=`IF($A21="","",
 _xlfn.LET(
  _xlpm.d,$A21,
  _xlpm.ti,$B21, _xlpm.eo,$E21, _xlpm.bs,$C21, _xlpm.be,$D21,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K21)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G21`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J21`: A1=`IF(OR($A21="",$G21="",$I21=""),"",
  _xlfn.LET(
    _xlpm.st,$G21,_xlpm.en,$I21,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N21`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `U21`: A1=`IF(T21="","",
 _xlfn.LET(
   _xlpm.nm,T21,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `V21`: A1=`IF(T21="","",
 _xlfn.LET(
  _xlpm.nm,T21,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 78.75)
- `A22`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A21),FIND("]",CELL("filename",A21))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44304)
- `C22`: A1=`IF($A22="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D22`: A1=`IF($A22="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E22`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F22`: A1=`IF($A22="","",
 _xlfn.LET(
  _xlpm.d,$A22,
  _xlpm.ti,$B22, _xlpm.eo,$E22, _xlpm.bs,$C22, _xlpm.be,$D22,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K22)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G22`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J22`: A1=`IF(OR($A22="",$G22="",$I22=""),"",
  _xlfn.LET(
    _xlpm.st,$G22,_xlpm.en,$I22,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N22`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U22`: A1=`IF(T22="","",
 _xlfn.LET(
   _xlpm.nm,T22,
   _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
              MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
   SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `V22`: A1=`IF(T22="","",
 _xlfn.LET(
  _xlpm.nm,T22,
  _xlpm.code,INDEX(staffsettings!$AN$2:$AN$6,
             MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
  _xlpm.hWD,IFERROR($F$40,0),
  _xlpm.hWDI,IFERROR($F$44,0),
  _xlpm.fac,IFERROR(INDEX(staffsettings!$AL$2:$AL$6,
                    MATCH(_xlpm.code,staffsettings!$AN$2:$AN$6,0)),1),
  ROUND(
    SUMPRODUCT(
      ($L$3:$L$33=_xlpm.code)*
      IF($J$3:$J$33="",0,$J$3:$J$33)*
      IF($M$3:$M$33="WDI",_xlpm.hWDI,_xlpm.hWD)*
      _xlpm.fac
    ),
  2)
 )
)`; R1C1=`(not available in source)` (Column header: 94.5)
- `A23`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A22),FIND("]",CELL("filename",A22))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44305)
- `C23`: A1=`IF($A23="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D23`: A1=`IF($A23="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E23`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F23`: A1=`IF($A23="","",
 _xlfn.LET(
  _xlpm.d,$A23,
  _xlpm.ti,$B23, _xlpm.eo,$E23, _xlpm.bs,$C23, _xlpm.be,$D23,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K23)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G23`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J23`: A1=`IF(OR($A23="",$G23="",$I23=""),"",
  _xlfn.LET(
    _xlpm.st,$G23,_xlpm.en,$I23,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N23`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `U23`: A1=`IF(T23="","",
 _xlfn.LET(
  _xlpm.nm,T23,
  _xlpm.code,IFERROR(
         INDEX(staffsettings!$AN$2:$AN$6,MATCH(_xlpm.nm,staffsettings!$AM$2:$AM$6,0)),
         INDEX(staffsettings!$AN$2:$AN$6,MATCH(_xlpm.nm,staffsettings!$AO$2:$AO$6,0))
       ),
  SUMIFS($J$3:$J$33,$L$3:$L$33,_xlpm.code)
 )
)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `A24`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A23),FIND("]",CELL("filename",A23))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44306)
- `C24`: A1=`IF($A24="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D24`: A1=`IF($A24="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E24`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F24`: A1=`IF($A24="","",
 _xlfn.LET(
  _xlpm.d,$A24,
  _xlpm.ti,$B24, _xlpm.eo,$E24, _xlpm.bs,$C24, _xlpm.be,$D24,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K24)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G24`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J24`: A1=`IF(OR($A24="",$G24="",$I24=""),"",
  _xlfn.LET(
    _xlpm.st,$G24,_xlpm.en,$I24,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N24`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A25`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A24),FIND("]",CELL("filename",A24))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44307)
- `C25`: A1=`IF($A25="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D25`: A1=`IF($A25="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E25`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F25`: A1=`IF($A25="","",
 _xlfn.LET(
  _xlpm.d,$A25,
  _xlpm.ti,$B25, _xlpm.eo,$E25, _xlpm.bs,$C25, _xlpm.be,$D25,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K25)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G25`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J25`: A1=`IF(OR($A25="",$G25="",$I25=""),"",
  _xlfn.LET(
    _xlpm.st,$G25,_xlpm.en,$I25,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N25`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A26`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A25),FIND("]",CELL("filename",A25))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44308)
- `C26`: A1=`IF($A26="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D26`: A1=`IF($A26="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E26`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F26`: A1=`IF($A26="","",
 _xlfn.LET(
  _xlpm.d,$A26,
  _xlpm.ti,$B26, _xlpm.eo,$E26, _xlpm.bs,$C26, _xlpm.be,$D26,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K26)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G26`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J26`: A1=`IF(OR($A26="",$G26="",$I26=""),"",
  _xlfn.LET(
    _xlpm.st,$G26,_xlpm.en,$I26,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N26`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A27`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A26),FIND("]",CELL("filename",A26))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44309)
- `C27`: A1=`IF($A27="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D27`: A1=`IF($A27="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E27`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F27`: A1=`IF($A27="","",
 _xlfn.LET(
  _xlpm.d,$A27,
  _xlpm.ti,$B27, _xlpm.eo,$E27, _xlpm.bs,$C27, _xlpm.be,$D27,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K27)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G27`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J27`: A1=`IF(OR($A27="",$G27="",$I27=""),"",
  _xlfn.LET(
    _xlpm.st,$G27,_xlpm.en,$I27,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N27`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A28`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A27),FIND("]",CELL("filename",A27))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44310)
- `C28`: A1=`IF($A28="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D28`: A1=`IF($A28="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E28`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F28`: A1=`IF($A28="","",
 _xlfn.LET(
  _xlpm.d,$A28,
  _xlpm.ti,$B28, _xlpm.eo,$E28, _xlpm.bs,$C28, _xlpm.be,$D28,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K28)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G28`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J28`: A1=`IF(OR($A28="",$G28="",$I28=""),"",
  _xlfn.LET(
    _xlpm.st,$G28,_xlpm.en,$I28,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N28`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A29`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A28),FIND("]",CELL("filename",A28))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44311)
- `C29`: A1=`IF($A29="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D29`: A1=`IF($A29="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E29`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F29`: A1=`IF($A29="","",
 _xlfn.LET(
  _xlpm.d,$A29,
  _xlpm.ti,$B29, _xlpm.eo,$E29, _xlpm.bs,$C29, _xlpm.be,$D29,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K29)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G29`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J29`: A1=`IF(OR($A29="",$G29="",$I29=""),"",
  _xlfn.LET(
    _xlpm.st,$G29,_xlpm.en,$I29,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N29`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `A30`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A29),FIND("]",CELL("filename",A29))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44312)
- `C30`: A1=`IF($A30="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D30`: A1=`IF($A30="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E30`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F30`: A1=`IF($A30="","",
 _xlfn.LET(
  _xlpm.d,$A30,
  _xlpm.ti,$B30, _xlpm.eo,$E30, _xlpm.bs,$C30, _xlpm.be,$D30,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K30)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G30`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J30`: A1=`IF(OR($A30="",$G30="",$I30=""),"",
  _xlfn.LET(
    _xlpm.st,$G30,_xlpm.en,$I30,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N30`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `W30`: A1=`_xlfn.LET(
 _xlpm.lbl, {"Full Name";"Staff ID";"IC/Passport";"Join Date";"Department";"Designation";"Bank Name";"Bank Account";"Annual Leave Balance (days)"},
 _xlpm.vA, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$A:$A, staffsettings!$B:$B, ""),
 _xlpm.vD, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$D:$D, staffsettings!$E:$E, ""),
 _xlpm.vG, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$G:$G, staffsettings!$H:$H, ""),
 _xlpm.vJ, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$J:$J, staffsettings!$K:$K, ""),
 _xlpm.val, IF(_xlpm.vA<>"",_xlpm.vA,IF(_xlpm.vD<>"",_xlpm.vD,IF(_xlpm.vG<>"",_xlpm.vG,_xlpm.vJ))),
 _xlfn._xlws.FILTER(_xlpm.lbl, _xlpm.val<>"")
)`; R1C1=`(not available in source)` (Column header: DEDUCTIONS)
- `Y30`: A1=`_xlfn.LET(
 _xlpm.lbl, {"Full Name";"Staff ID";"IC/Passport";"Join Date";"Department";"Designation";"Bank Name";"Bank Account";"Annual Leave Balance (days)"},
 _xlpm.vA, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$A:$A, staffsettings!$B:$B, ""),
 _xlpm.vD, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$D:$D, staffsettings!$E:$E, ""),
 _xlpm.vG, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$G:$G, staffsettings!$H:$H, ""),
 _xlpm.vJ, _xlfn.XLOOKUP(_xlpm.lbl, staffsettings!$J:$J, staffsettings!$K:$K, ""),
 _xlpm.val, IF(_xlpm.vA<>"",_xlpm.vA,IF(_xlpm.vD<>"",_xlpm.vD,IF(_xlpm.vG<>"",_xlpm.vG,_xlpm.vJ))),
 _xlpm.disp, IF(_xlpm.lbl="Bank Account", IF(_xlpm.val="","", IF(ISTEXT(_xlpm.val), _xlpm.val, TEXT(_xlpm.val, REPT("0",12)))), _xlpm.val),
 _xlfn._xlws.FILTER(_xlpm.disp, _xlpm.val<>"")
)`; R1C1=`(not available in source)` (Column header: PAYSLIP - APRIL 2025)
- `A31`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A30),FIND("]",CELL("filename",A30))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44313)
- `C31`: A1=`IF($A31="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D31`: A1=`IF($A31="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E31`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F31`: A1=`IF($A31="","",
 _xlfn.LET(
  _xlpm.d,$A31,
  _xlpm.ti,$B31, _xlpm.eo,$E31, _xlpm.bs,$C31, _xlpm.be,$D31,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K31)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0)
- `G31`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J31`: A1=`IF(OR($A31="",$G31="",$I31=""),"",
  _xlfn.LET(
    _xlpm.st,$G31,_xlpm.en,$I31,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N31`: A1=``; R1C1=`(not available in source)` (Column header: 0)
- `W31`: A1=``; R1C1=`(not available in source)` (Column header: Full Name)
- `Y31`: A1=``; R1C1=`(not available in source)` (Column header: MOHD AZLIN NASUTION BIN ABDUL AZIZ)
- `A32`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A31),FIND("]",CELL("filename",A31))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44314)
- `C32`: A1=`IF($A32="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D32`: A1=`IF($A32="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E32`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F32`: A1=`IF($A32="","",
 _xlfn.LET(
  _xlpm.d,$A32,
  _xlpm.ti,$B32, _xlpm.eo,$E32, _xlpm.bs,$C32, _xlpm.be,$D32,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K32)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G32`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J32`: A1=`IF(OR($A32="",$G32="",$I32=""),"",
  _xlfn.LET(
    _xlpm.st,$G32,_xlpm.en,$I32,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N32`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `A33`: A1=`_xlfn.LET(
  _xlpm.yr, VALUE(companysettings!$N$2),
  _xlpm.mn, IFERROR(VALUE(MID(CELL("filename",A32),FIND("]",CELL("filename",A32))+1,2)),$H$2),
  IF(OR(_xlpm.yr="",_xlpm.mn=""),"",
     IF(ROW()-2>DAY(EOMONTH(DATE(_xlpm.yr,_xlpm.mn,1),0)),"",DATE(_xlpm.yr,_xlpm.mn,ROW()-2))
  )
)`; R1C1=`(not available in source)` (Column header: 44315)
- `C33`: A1=`IF($A33="","",
  _xlfn.LET(_xlpm.bs,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break Start",staffsettings!$U:$U,0)),""),
      IF(_xlpm.bs<>"",_xlpm.bs,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break Start",companysettings!$Q:$Q,0)),TIME(12,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.5)
- `D33`: A1=`IF($A33="","",
  _xlfn.LET(_xlpm.be,IFERROR(INDEX(staffsettings!$V:$V,MATCH("Break End",staffsettings!$U:$U,0)),""),
      IF(_xlpm.be<>"",_xlpm.be,IFERROR(INDEX(companysettings!$R:$R,MATCH("Break End",companysettings!$Q:$Q,0)),TIME(13,0,0)))
  )
)`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `E33`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `F33`: A1=`IF($A33="","",
 _xlfn.LET(
  _xlpm.d,$A33,
  _xlpm.ti,$B33, _xlpm.eo,$E33, _xlpm.bs,$C33, _xlpm.be,$D33,
  _xlpm.nti,IF(_xlpm.ti="","",IF(ISNUMBER(_xlpm.ti),MOD(_xlpm.ti,1),IFERROR(TIMEVALUE(_xlpm.ti),""))),
  _xlpm.neo,IF(_xlpm.eo="","",IF(ISNUMBER(_xlpm.eo),MOD(_xlpm.eo,1),IFERROR(TIMEVALUE(_xlpm.eo),""))),
  _xlpm.nbs,IF(_xlpm.bs="","",IF(ISNUMBER(_xlpm.bs),MOD(_xlpm.bs,1),IFERROR(TIMEVALUE(_xlpm.bs),""))),
  _xlpm.nbe,IF(_xlpm.be="","",IF(ISNUMBER(_xlpm.be),MOD(_xlpm.be,1),IFERROR(TIMEVALUE(_xlpm.be),""))),
  _xlpm.has,AND(_xlpm.nti<>"",_xlpm.neo<>""),

  _xlpm.brk,IF(AND(_xlpm.has,_xlpm.nbs<>"",_xlpm.nbe<>"",_xlpm.nbe>_xlpm.nbs),
         MAX(0,MIN(_xlpm.nbe,_xlpm.neo)-MAX(_xlpm.nbs,_xlpm.nti)),0),
  _xlpm.actd,IF(_xlpm.has,MAX(0,(_xlpm.neo-_xlpm.nti)-_xlpm.brk),0),

  _xlpm.reqd_raw,staffsettings!$V$2,
  _xlpm.reqd,
    IF(ISNUMBER(_xlpm.reqd_raw),
       MOD(_xlpm.reqd_raw,1),
       IF(_xlpm.reqd_raw="","",MOD(TIMEVALUE(_xlpm.reqd_raw),1))),

  _xlpm.offMon,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Mon",staffsettings!$AC:$AC,0)),
  _xlpm.offTue,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Tue",staffsettings!$AC:$AC,0)),
  _xlpm.offWed,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Wed",staffsettings!$AC:$AC,0)),
  _xlpm.offThu,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Thu",staffsettings!$AC:$AC,0)),
  _xlpm.offFri,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Fri",staffsettings!$AC:$AC,0)),
  _xlpm.offSat,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sat",staffsettings!$AC:$AC,0)),
  _xlpm.offSun,INDEX(staffsettings!$AD:$AD,MATCH("Weekly Off Sun",staffsettings!$AC:$AC,0)),
  _xlpm.offToday,
    UPPER(CHOOSE(WEEKDAY(_xlpm.d,2),
                 _xlpm.offMon,_xlpm.offTue,_xlpm.offWed,_xlpm.offThu,_xlpm.offFri,_xlpm.offSat,_xlpm.offSun))="YES",

  _xlpm.lastOffDOW,
    IF(UPPER(_xlpm.offSun)="YES",7,
    IF(UPPER(_xlpm.offSat)="YES",6,
    IF(UPPER(_xlpm.offFri)="YES",5,
    IF(UPPER(_xlpm.offThu)="YES",4,
    IF(UPPER(_xlpm.offWed)="YES",3,
    IF(UPPER(_xlpm.offTue)="YES",2,
    IF(UPPER(_xlpm.offMon)="YES",1,0))))))),

  _xlpm.obs,UPPER(INDEX(staffsettings!$AD:$AD,
                  MATCH("Observe Public Holidays",staffsettings!$AC:$AC,0))),
  _xlpm.isPHtoday,ISNUMBER(MATCH(_xlpm.d,holidays!$E:$E,0)),
  _xlpm.isPHrepl,AND(ISNUMBER(MATCH(_xlpm.d-1,holidays!$E:$E,0)),
               WEEKDAY(_xlpm.d-1,2)=_xlpm.lastOffDOW,NOT(_xlpm.offToday)),
  _xlpm.isPHpay,AND(_xlpm.obs="YES",
              OR(AND(_xlpm.isPHtoday,NOT(_xlpm.offToday)),_xlpm.isPHrepl)),

  _xlpm.st,UPPER(TRIM($K33)),
  _xlpm.pt,UPPER(INDEX(staffsettings!$R:$R,MATCH("Pay Type",staffsettings!$Q:$Q,0))),
  _xlpm.mpwt,UPPER(INDEX(staffsettings!$R:$R,
                   MATCH("Monthly Present Without Time",staffsettings!$Q:$Q,0))),
  _xlpm.hd,IFERROR(VALUE(INDEX(staffsettings!$R:$R,
                         MATCH("Half Day Credit",staffsettings!$Q:$Q,0))),0.5),

  _xlpm.base,
    IF(_xlpm.isPHpay,0,
      IF(_xlpm.offToday,0,
        IF(OR(_xlpm.st="AL",_xlpm.st="SL"),0,
          IF(_xlpm.st="FD",0,
            IF(_xlpm.st="HD",_xlpm.reqd*(1-_xlpm.hd),
              IF(_xlpm.st="PR",_xlpm.reqd,
                IF(AND(_xlpm.st="",_xlpm.pt="MONTHLY",_xlpm.mpwt="PAID",NOT(_xlpm.has)),0,_xlpm.reqd)
              )
            )
          )
        )
      )
    ),

  MAX(0,_xlpm.base-_xlpm.actd)
 )
)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `G33`: A1=``; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `J33`: A1=`IF(OR($A33="",$G33="",$I33=""),"",
  _xlfn.LET(
    _xlpm.st,$G33,_xlpm.en,$I33,
    _xlpm.dh,IF(_xlpm.en<_xlpm.st,(_xlpm.en+1-_xlpm.st)*24,(_xlpm.en-_xlpm.st)*24),
    _xlpm.bdRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Duration",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Duration",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.thRaw,IFERROR(IFERROR(
            INDEX(staffsettings!$V:$V,MATCH("OT Break Threshold Hours",staffsettings!$U:$U,0)),
            INDEX(companysettings!$AH:$AH,MATCH("OT Break Threshold Hours",companysettings!$AG:$AG,0))
          ),0),
    _xlpm.bdH,IF(_xlpm.bdRaw<1,_xlpm.bdRaw*24,_xlpm.bdRaw),
    _xlpm.thH,IF(_xlpm.thRaw<1,_xlpm.thRaw*24,_xlpm.thRaw),
    _xlpm.cy,IF(_xlpm.thH=0,0,INT(_xlpm.dh/_xlpm.thH)),
    MAX(0, _xlpm.dh - _xlpm.cy*_xlpm.bdH)
  )
)`; R1C1=`(not available in source)` (Column header: 1.7999999999999983)
- `N33`: A1=``; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `D34`: A1=`SUMPRODUCT(N($F$3:$F$33))*24`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `G34`: A1=`IF(COUNTA($F$3:$F$33)=0,"",
 SUMPRODUCT(
   IF($F$3:$F$33="",
      0,
      IF(ISNUMBER($F$3:$F$33),
         $F$3:$F$33,
         IFERROR(TIMEVALUE($F$3:$F$33),0)
      )
   )
 )*24
)`; R1C1=`(not available in source)` (Column header: 0.70833333333333337)
- `N34`: A1=`SUM(N3:N30)`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `P36`: A1=`$K$2`; R1C1=`(not available in source)` (Column header: TOTAL)
- `R36`: A1=`$M$2`; R1C1=`(not available in source)` (Column header: TOTAL)
- `B37`: A1=`IF(D37="","",
 _xlfn.LET(
  _xlpm.rng,$F$3:$F$33,
  _xlpm.vals,IF(_xlpm.rng="","",IF(ISNUMBER(_xlpm.rng),_xlpm.rng,IFERROR(TIMEVALUE(_xlpm.rng),0))),
  _xlpm.totalH,SUM(_xlpm.vals)*24,
  _xlpm.hpd,IF(ISTEXT(staffsettings!$V$2),
         IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
         IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)),
  _xlpm.shortDays,IF(OR(_xlpm.totalH=0,_xlpm.hpd<=0),0,_xlpm.totalH/_xlpm.hpd),
  MAX(0,D37-_xlpm.shortDays)
 )
)`; R1C1=`(not available in source)` (Column header: PM)
- `C37`: A1=`companysettings!$N$35`; R1C1=`(not available in source)` (Column header: PY)
- `D37`: A1=`IF(COUNTA($A$3:$A$33)=0,"",
 _xlfn.LET(
  _xlpm.d,$A$3:$A$33,
  _xlpm.w,IF(_xlpm.d="",0,WEEKDAY(_xlpm.d,2)),
  _xlpm.mon,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Mon",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.tue,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Tue",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.wed,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Wed",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.thu,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Thu",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.fri,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Fri",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.sat,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sat",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.sun,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sun",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.off,(_xlpm.w=1)*_xlpm.mon+(_xlpm.w=2)*_xlpm.tue+(_xlpm.w=3)*_xlpm.wed+(_xlpm.w=4)*_xlpm.thu+(_xlpm.w=5)*_xlpm.fri+(_xlpm.w=6)*_xlpm.sat+(_xlpm.w=7)*_xlpm.sun,
  _xlpm.obs,--(UPPER(TRIM(_xlfn.XLOOKUP("Observe Public Holidays",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
  _xlpm.e,holidays!$E$2:$E$300,
  _xlpm.eTxt,IF(_xlpm.e="","",IFERROR(TEXT(_xlpm.e,"yyyy-mm-dd"),IFERROR(TEXT(DATEVALUE(_xlpm.e),"yyyy-mm-dd"),""))),
  _xlpm.dTxt,IF(_xlpm.d="","",TEXT(_xlpm.d,"yyyy-mm-dd")),
  _xlpm.ph,IF(_xlpm.obs,--ISNUMBER(_xlfn.XMATCH(_xlpm.dTxt,_xlpm.eTxt,0)),0),
  SUMPRODUCT((_xlpm.d<>"")*(_xlpm.off=0)*(_xlpm.ph=0))
 ))`; R1C1=`(not available in source)` (Column header: FMA)
- `E37`: A1=`companysettings!$N$39`; R1C1=`(not available in source)` (Column header: FYA)
- `J37`: A1=`IFERROR(
  J38 /
  IF(ISTEXT(staffsettings!$V$2),
     IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
     IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
  ),
0)`; R1C1=`(not available in source)` (Column header: OT)
- `O37`: A1=`staffsettings!I6`; R1C1=`(not available in source)` (Column header: Attandance)
- `P37`: A1=`staffsettings!L6`; R1C1=`(not available in source)` (Column header: ATT)
- `Q37`: A1=`staffsettings!S21`; R1C1=`(not available in source)` (Column header: Pay Structure)
- `R37`: A1=`staffsettings!T21`; R1C1=`(not available in source)` (Column header: PS)
- `B38`: A1=`_xlfn.LET(
 _xlpm.rng,$F$3:$F$33,
 _xlpm.vals,IF(_xlpm.rng="","",IF(ISNUMBER(_xlpm.rng),_xlpm.rng,IFERROR(TIMEVALUE(_xlpm.rng),0))),
 _xlpm.totalH,SUM(_xlpm.vals)*24,
 IF(_xlpm.totalH=0,"",_xlpm.totalH)
)`; R1C1=`(not available in source)` (Column header: 11)
- `C38`: A1=`companysettings!$N$36`; R1C1=`(not available in source)` (Column header: #REF!)
- `D38`: A1=`IF(D37="","",
 _xlfn.LET(
  _xlpm.h,IF(ISTEXT(staffsettings!$V$2),
        IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
        IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)
     ),
  D37*_xlpm.h
 ))`; R1C1=`(not available in source)` (Column header: 22)
- `E38`: A1=`companysettings!$N$40`; R1C1=`(not available in source)` (Column header: #REF!)
- `J38`: A1=`IFERROR(SUM(J3:J33),0)`; R1C1=`(not available in source)` (Column header: 2.2499999999999978)
- `O38`: A1=`staffsettings!I7`; R1C1=`(not available in source)` (Column header: Annual Leave)
- `P38`: A1=`staffsettings!L7`; R1C1=`(not available in source)` (Column header: AL)
- `Q38`: A1=`staffsettings!S22`; R1C1=`(not available in source)` (Column header: Work Days)
- `R38`: A1=`staffsettings!T22`; R1C1=`(not available in source)` (Column header: WD)
- `F39`: A1=`IF($F$49<=0,"",
  IF(N(staffsettings!$R$3)>0, staffsettings!$R$3/$F$49,
     IF(N(staffsettings!$R$4)>0, staffsettings!$R$4, "")
  )
)`; R1C1=`(not available in source)` (Column header: FULL)
- `J39`: A1=`IFERROR(_xlfn.LET(
  _xlpm.z,UPPER(TRIM(companysettings!$Z$8)),
  _xlpm.basis,IF(LEFT(_xlpm.z,3)="F37",$F$49,
        IF(LEFT(_xlpm.z,6)="ACTUAL",$F$49,
           IFERROR(VALUE(_xlpm.z),26))),
  _xlpm.h,IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
     IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)),
  _xlpm.sal,N(staffsettings!$R$3),
  _xlpm.dr,N(staffsettings!$R$4),
  _xlpm.hr,N(staffsettings!$R$5),
  _xlpm.dly,IF(_xlpm.sal>0, _xlpm.sal/_xlpm.basis,
       IF(_xlpm.dr>0, _xlpm.dr,
          IF(AND(_xlpm.hr>0,_xlpm.h>0), _xlpm.hr*_xlpm.h, ""))),
  _xlpm.dly
),"")`; R1C1=`(not available in source)` (Column header: 17.999999999999982)
- `O39`: A1=`staffsettings!I8`; R1C1=`(not available in source)` (Column header: Full Day)
- `P39`: A1=`staffsettings!L8`; R1C1=`(not available in source)` (Column header: FD)
- `Q39`: A1=`staffsettings!S23`; R1C1=`(not available in source)` (Column header: Work Days - Indoor)
- `R39`: A1=`staffsettings!T23`; R1C1=`(not available in source)` (Column header: WDI)
- `U39`: A1=`SUM(U18:U22)`; R1C1=`(not available in source)` (Column header: 3.5999999999999965)
- `F40`: A1=`IFERROR(
 IF(N(staffsettings!$R$3)>0,
    IF($F$50>0, staffsettings!$R$3/$F$50, ""),
    IF(N(staffsettings!$R$5)>0,
       staffsettings!$R$5,
       IF(AND(N(staffsettings!$R$4)>0,
              IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
                 IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2))>0),
          staffsettings!$R$4/
            IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
               IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)),
          ""
       )
    )
 ),
"")`; R1C1=`(not available in source)` (Column header: 81.818181818181813)
- `J40`: A1=`IFERROR(_xlfn.LET(
  _xlpm.z,UPPER(TRIM(companysettings!$Z$8)),
  _xlpm.h,IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2)),
  _xlpm.basis,IF(LEFT(_xlpm.z,3)="F37",$F$49,IF(LEFT(_xlpm.z,6)="ACTUAL",$F$49,IFERROR(VALUE(_xlpm.z),26))),
  _xlpm.sal,N(staffsettings!$R$3),
  _xlpm.dr,N(staffsettings!$R$4),
  _xlpm.hr,N(staffsettings!$R$5),
  _xlpm.dly,IF(_xlpm.sal>0,_xlpm.sal/_xlpm.basis,IF(_xlpm.dr>0,_xlpm.dr,IF(AND(_xlpm.hr>0,_xlpm.h>0),_xlpm.hr*_xlpm.h,""))),
  IF(_xlpm.h<=0,"",IF(_xlpm.dly="","",_xlpm.dly/_xlpm.h))
),"")`; R1C1=`(not available in source)` (Column header: 69.230769230769226)
- `O40`: A1=`staffsettings!I9`; R1C1=`(not available in source)` (Column header: Half Day)
- `P40`: A1=`staffsettings!L9`; R1C1=`(not available in source)` (Column header: HD)
- `Q40`: A1=`staffsettings!S24`; R1C1=`(not available in source)` (Column header: 0)
- `R40`: A1=`staffsettings!T24`; R1C1=`(not available in source)` (Column header: 0)
- `F41`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,
_xlpm.obs,--(UPPER(TRIM(_xlfn.XLOOKUP("Observe Public Holidays",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No")))="YES"),
_xlpm.elist,IFERROR(_xlfn._xlws.FILTER(holidays!$E$2:$E$30,holidays!$E$2:$E$30<>""),""),
_xlpm.dTxt,TEXT(_xlpm.d,"yyyy-mm-dd"),
_xlpm.eTxt,IF(_xlpm.elist="","",TEXT(_xlpm.elist,"yyyy-mm-dd")),
IF(_xlpm.obs,SUMPRODUCT(($A$3:$A$33<>"")*ISNUMBER(MATCH(_xlpm.dTxt,_xlpm.eTxt,0))),0))`; R1C1=`(not available in source)` (Column header: 10.227272727272727)
- `J41`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,
_xlpm.obs,--(UPPER(TRIM(_xlfn.XLOOKUP("Observe Public Holidays",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No")))="YES"),
_xlpm.elist,IFERROR(_xlfn._xlws.FILTER(holidays!$E$2:$E$30,holidays!$E$2:$E$30<>""),""),
_xlpm.dTxt,TEXT(_xlpm.d,"yyyy-mm-dd"),
_xlpm.eTxt,IF(_xlpm.elist="","",TEXT(_xlpm.elist,"yyyy-mm-dd")),
IF(_xlpm.obs,SUMPRODUCT(($A$3:$A$33<>"")*ISNUMBER(MATCH(_xlpm.dTxt,_xlpm.eTxt,0))),0))`; R1C1=`(not available in source)` (Column header: 8.6538461538461533)
- `O41`: A1=`staffsettings!I10`; R1C1=`(not available in source)` (Column header: Present)
- `P41`: A1=`staffsettings!L10`; R1C1=`(not available in source)` (Column header: PR)
- `T41`: A1=`U11`; R1C1=`(not available in source)` (Column header: OVERTIME  EARNINGS)
- `U41`: A1=`F39`; R1C1=`(not available in source)` (Column header: 17.999999999999982)
- `F42`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,_xlpm.w,IF($A$3:$A$33="",0,WEEKDAY($A$3:$A$33,2)),
_xlpm.mon,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Mon",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.tue,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Tue",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.wed,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Wed",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.thu,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Thu",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.fri,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Fri",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sat,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sat",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sun,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sun",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
SUMPRODUCT(($A$3:$A$33<>"")*((_xlpm.w=1)*_xlpm.mon+(_xlpm.w=2)*_xlpm.tue+(_xlpm.w=3)*_xlpm.wed+(_xlpm.w=4)*_xlpm.thu+(_xlpm.w=5)*_xlpm.fri+(_xlpm.w=6)*_xlpm.sat+(_xlpm.w=7)*_xlpm.sun)))`; R1C1=`(not available in source)` (Column header: 0)
- `J42`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,_xlpm.w,IF($A$3:$A$33="",0,WEEKDAY($A$3:$A$33,2)),
_xlpm.mon,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Mon",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.tue,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Tue",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.wed,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Wed",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.thu,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Thu",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.fri,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Fri",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sat,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sat",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sun,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sun",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
SUMPRODUCT(($A$3:$A$33<>"")*((_xlpm.w=1)*_xlpm.mon+(_xlpm.w=2)*_xlpm.tue+(_xlpm.w=3)*_xlpm.wed+(_xlpm.w=4)*_xlpm.thu+(_xlpm.w=5)*_xlpm.fri+(_xlpm.w=6)*_xlpm.sat+(_xlpm.w=7)*_xlpm.sun)))`; R1C1=`(not available in source)` (Column header: 0)
- `T42`: A1=`U12`; R1C1=`(not available in source)` (Column header: 4.25)
- `U42`: A1=`F40`; R1C1=`(not available in source)` (Column header: 81.818181818181813)
- `V42`: A1=`T42*U42`; R1C1=`(not available in source)` (Column header: 126)
- `F43`: A1=`IFERROR(IF(N(staffsettings!$R$8)>0,N(staffsettings!$R$8),""),"")`; R1C1=`(not available in source)` (Column header: 8)
- `J43`: A1=`IFERROR(IF(N(staffsettings!$R$8)>0,N(staffsettings!$R$8),""),"")`; R1C1=`(not available in source)` (Column header: 8)
- `P43`: A1=`$L$2`; R1C1=`(not available in source)` (Column header: SL)
- `T43`: A1=``; R1C1=`(not available in source)` (Column header: 34)
- `U43`: A1=`F43`; R1C1=`(not available in source)` (Column header: 10.227272727272727)
- `F44`: A1=`IFERROR(IF(N(staffsettings!$R$9)>0,N(staffsettings!$R$9),""),"")`; R1C1=`(not available in source)` (Column header: 70)
- `J44`: A1=`IFERROR(IF(N(staffsettings!$R$9)>0,N(staffsettings!$R$9),""),"")`; R1C1=`(not available in source)` (Column header: 70)
- `O44`: A1=`staffsettings!AM2`; R1C1=`(not available in source)` (Column header: Overtime)
- `P44`: A1=`staffsettings!AN2`; R1C1=`(not available in source)` (Column header: OT)
- `T44`: A1=``; R1C1=`(not available in source)` (Column header: 59.5)
- `U44`: A1=`F44`; R1C1=`(not available in source)` (Column header: 70)
- `V44`: A1=``; R1C1=`(not available in source)` (Column header: 347.72727272727269)
- `F45`: A1=`IF(COUNTA($A$3:$A$33)=0,"",24*SUMIFS($F$3:$F$33,$M$3:$M$33,"WD"))`; R1C1=`(not available in source)` (Column header: 8.75)
- `J45`: A1=`SUM($J$3:$J$33)`; R1C1=`(not available in source)` (Column header: 8.75)
- `O45`: A1=`staffsettings!AM3`; R1C1=`(not available in source)` (Column header: Default)
- `P45`: A1=`staffsettings!AN3`; R1C1=`(not available in source)` (Column header: N)
- `V45`: A1=`SUM(V41:V44)`; R1C1=`(not available in source)` (Column header: 4165)
- `F46`: A1=`IF(COUNTA($A$3:$A$33)=0,"",24*SUMIFS($F$3:$F$33,$M$3:$M$33,"WDI"))`; R1C1=`(not available in source)` (Column header: 0)
- `J46`: A1=`SUM($U$18:$U$30)`; R1C1=`(not available in source)` (Column header: 17.999999999999982)
- `O46`: A1=`staffsettings!AM4`; R1C1=`(not available in source)` (Column header: Rest Day)
- `P46`: A1=`staffsettings!AN4`; R1C1=`(not available in source)` (Column header: RD)
- `O47`: A1=`staffsettings!AM5`; R1C1=`(not available in source)` (Column header: Public Holiday)
- `P47`: A1=`staffsettings!AN5`; R1C1=`(not available in source)` (Column header: P)
- `V47`: A1=`F50*F40`; R1C1=`(not available in source)` (Column header: 4512.727272727273)
- `O48`: A1=`staffsettings!AM6`; R1C1=`(not available in source)` (Column header: PH on Rest Day)
- `P48`: A1=`staffsettings!AN6`; R1C1=`(not available in source)` (Column header: PR)
- `V48`: A1=` $F$50 - _xlfn.LET(
 _xlpm.hs,$F$3:$F$33,
 _xlpm.hsD,IF(_xlpm.hs="",
        0,
        IF(ISNUMBER(_xlpm.hs),
           MOD(_xlpm.hs,1),
           IFERROR(MOD(TIMEVALUE(_xlpm.hs),1),0)
        )
     ),
 24*SUM(_xlpm.hsD)
)`; R1C1=`(not available in source)` (Column header: 1800)
- `F49`: A1=`_xlfn.LET(_xlpm.d,$A$3:$A$33,_xlpm.w,IF($A$3:$A$33="",0,WEEKDAY($A$3:$A$33,2)),
_xlpm.mon,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Mon",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.tue,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Tue",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.wed,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Wed",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.thu,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Thu",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.fri,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Fri",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sat,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sat",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.sun,--(UPPER(TRIM(_xlfn.XLOOKUP("Weekly Off Sun",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.off,(_xlpm.w=1)*_xlpm.mon+(_xlpm.w=2)*_xlpm.tue+(_xlpm.w=3)*_xlpm.wed+(_xlpm.w=4)*_xlpm.thu+(_xlpm.w=5)*_xlpm.fri+(_xlpm.w=6)*_xlpm.sat+(_xlpm.w=7)*_xlpm.sun,
_xlpm.obs,--(UPPER(TRIM(_xlfn.XLOOKUP("Observe Public Holidays",staffsettings!$AC:$AC,staffsettings!$AD:$AD,"No",0)))="YES"),
_xlpm.e,holidays!$E$2:$E$30,
_xlpm.eTxt,IF(_xlpm.e="", "", IFERROR(TEXT(_xlpm.e,"yyyy-mm-dd"), IFERROR(TEXT(DATEVALUE(_xlpm.e),"yyyy-mm-dd"),""))),
_xlpm.dTxt,IF(_xlpm.d="", "", TEXT(_xlpm.d,"yyyy-mm-dd")),
_xlpm.ph,IF(_xlpm.obs, --ISNUMBER(_xlfn.XMATCH(_xlpm.dTxt,_xlpm.eTxt,0)), 0),
SUMPRODUCT(($A$3:$A$33<>"")*(_xlpm.off=0)*(_xlpm.ph=0)))`; R1C1=`(not available in source)` (Column header: 88)
- `V49`: A1=` $F$50 - _xlfn.LET(
 _xlpm.hs,$F$3:$F$33,
 _xlpm.hsD,IF(_xlpm.hs="",
        0,
        IF(ISNUMBER(_xlpm.hs),
           MOD(_xlpm.hs,1),
           IFERROR(MOD(TIMEVALUE(_xlpm.hs),1),0)
        )
     ),
 24*SUM(_xlpm.hsD)
)`; R1C1=`(not available in source)` (Column header: 88)
- `F50`: A1=`IF($F$49<=0,"",
 $F$49 *
 IF(ISTEXT(staffsettings!$V$2),IFERROR(TIMEVALUE(staffsettings!$V$2)*24,0),
    IF(staffsettings!$V$2<1,staffsettings!$V$2*24,staffsettings!$V$2))
)`; R1C1=`(not available in source)` (Column header: 22)

### Data Validations
- `L3:L33`: type=list operator=None formula1=`OTTypeList` formula2=`None` (Column header: OT)
- `K3:K33`: type=list operator=None formula1=`AttendanceList` formula2=`None` (Column header: ATT)
- `M3:M33`: type=list operator=None formula1=`PayStructureList` formula2=`None` (Column header: PS)

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: companysettings

### Summary
- **Used range**: `A1:BH44`
- **Excel Tables**: None

### Formulas
- `R3`: A1=`R2/1`; R1C1=`(not available in source)` (Column header: 0.39583333333333331)
- `R4`: A1=`R2/2`; R1C1=`(not available in source)` (Column header: 0.39583333333333331)
- `C10`: A1=`_xlfn.UNICHAR(9742)&_xlfn.UNICHAR(65038)`; R1C1=`(not available in source)` (Column header: Note)
- `C11`: A1=`_xlfn.UNICHAR(128241)&_xlfn.UNICHAR(65038)`; R1C1=`(not available in source)` (Column header: )
- `C12`: A1=`_xlfn.UNICHAR(128224)&_xlfn.UNICHAR(65038)`; R1C1=`(not available in source)` (Column header: )
- `C13`: A1=`_xlfn.UNICHAR(9993)&_xlfn.UNICHAR(65038)`; R1C1=`(not available in source)` (Column header: )
- `C14`: A1=`_xlfn.UNICHAR(127760)&_xlfn.UNICHAR(65038)`; R1C1=`(not available in source)` (Column header: )
- `C15`: A1=`_xlfn.UNICHAR(9834)`; R1C1=`(not available in source)` (Column header: )
- `C16`: A1=`_xlfn.UNICHAR(9403)`; R1C1=`(not available in source)` (Column header: )
- `C17`: A1=`_xlfn.UNICHAR(128247)&_xlfn.UNICHAR(65038)`; R1C1=`(not available in source)` (Column header: )
- `C18`: A1=`_xlfn.UNICHAR(9654)`; R1C1=`(not available in source)` (Column header: )
- `C19`: A1=`_xlfn.UNICHAR(128038)&_xlfn.UNICHAR(65038)`; R1C1=`(not available in source)` (Column header: )
- `N33`: A1=`IF($L$33="","",INDIRECT("'" & TEXT($L$33,"00") & "'!$B$37"))`; R1C1=`(not available in source)` (Column header: Value)
- `N34`: A1=`IF($L$33="","",INDIRECT("'" & TEXT($L$33,"00") & "'!$C$37"))`; R1C1=`(not available in source)` (Column header: #REF!)
- `N35`: A1=`SUMPRODUCT( N( INDIRECT("'" & TEXT($L$34:$L$45,"00") & "'!$B$37") ) )`; R1C1=`(not available in source)` (Column header: #REF!)
- `N36`: A1=`SUMPRODUCT( N( INDIRECT("'" & TEXT($L$34:$L$45,"00") & "'!$C$37") ) )`; R1C1=`(not available in source)` (Column header: #REF!)
- `N37`: A1=`IF($L$33="","",INDIRECT("'" & TEXT($L$33,"00") & "'!$D$37"))`; R1C1=`(not available in source)` (Column header: #REF!)
- `N38`: A1=`IF($L$33="","",INDIRECT("'" & TEXT($L$33,"00") & "'!$E$37"))`; R1C1=`(not available in source)` (Column header: #REF!)
- `N39`: A1=`SUMPRODUCT( N( INDIRECT("'" & TEXT($L$34:$L$45,"00") & "'!$D$37") ) )`; R1C1=`(not available in source)` (Column header: #REF!)
- `N40`: A1=`SUMPRODUCT( N( INDIRECT("'" & TEXT($L$34:$L$45,"00") & "'!$E$37") ) )`; R1C1=`(not available in source)` (Column header: #REF!)

### Data Validations
- None

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: staffsettings

### Summary
- **Used range**: `A1:AO30`
- **Excel Tables**: None

### Formulas
- `V3`: A1=`companysettings!R5`; R1C1=`(not available in source)` (Column header: 0.33333333333333331)
- `V4`: A1=`companysettings!R6`; R1C1=`(not available in source)` (Column header: 0.5)
- `R5`: A1=`IFERROR(
 IF((IF(ISTEXT(V2),IFERROR(TIMEVALUE(V2),0),V2)*24)<=0,"",
   IF(LEFT(UPPER(TRIM(companysettings!$Z$8)),6)="ACTUAL",
      IF(N(R3)>0, R3/$F$37/(IF(ISTEXT(V2),IFERROR(TIMEVALUE(V2),0),V2)*24),
         IF(N(R4)>0, R4/(IF(ISTEXT(V2),IFERROR(TIMEVALUE(V2),0),V2)*24), "")),
      IF(N(R3)>0, R3/26/(IF(ISTEXT(V2),IFERROR(TIMEVALUE(V2),0),V2)*24),
         IF(N(R4)>0, R4/(IF(ISTEXT(V2),IFERROR(TIMEVALUE(V2),0),V2)*24), ""))
   )
 ),"")`; R1C1=`(not available in source)` (Column header: 80)
- `V5`: A1=`companysettings!AH2`; R1C1=`(not available in source)` (Column header: 0.54166666666666663)
- `J6`: A1=`_xlfn.LET(
  _xlpm.ent, N($J$3),
  _xlpm.s, "'"&TEXT(ROW($1:$12),"00")&"'!$K$3:$K$33",
  _xlpm.taken, SUMPRODUCT(IFERROR(COUNTIF(INDIRECT(_xlpm.s),"Ann Leave"),0)),
  IF(_xlpm.ent="","", _xlpm.ent - _xlpm.taken)
)`; R1C1=`(not available in source)` (Column header: 8)
- `V6`: A1=`companysettings!AH3`; R1C1=`(not available in source)` (Column header: 4.1666666666666666E-3)
- `R9`: A1=`_xlfn.LET(_xlpm.r,R8,_xlpm.t,V2,_xlpm.n,IF(ISTEXT(_xlpm.t),IFERROR(TIMEVALUE(_xlpm.t),0),_xlpm.t),IF(OR(_xlpm.r<=0,_xlpm.n<=0),"",IFERROR(_xlpm.r/(_xlpm.n*24),"")))`; R1C1=`(not available in source)` (Column header: 70)
- `Q21`: A1=`IFERROR(INDEX($Q$2:$Q$20, MATCH(_xlfn.UNIQUE(_xlfn._xlws.FILTER($T$2:$T$20,$T$2:$T$20<>"")), $T$2:$T$20, 0)),"")`; R1C1=`(not available in source)` (Column header: Indoor Hourly Rate)
- `R21`: A1=`IFERROR(INDEX($R$2:$R$20, MATCH(_xlfn.UNIQUE(_xlfn._xlws.FILTER($T$2:$T$20,$T$2:$T$20<>"")), $T$2:$T$20, 0)),"")`; R1C1=`(not available in source)` (Column header: 8.75)
- `S21`: A1=`IFERROR(INDEX($S$2:$S$20, MATCH(_xlfn.UNIQUE(_xlfn._xlws.FILTER($T$2:$T$20,$T$2:$T$20<>"")), $T$2:$T$20, 0)),"")`; R1C1=`(not available in source)` (Column header: Work Hours - Indoor)
- `T21`: A1=`IFERROR(_xlfn.UNIQUE(_xlfn._xlws.FILTER($T$2:$T$20,$T$2:$T$20<>"")),"")`; R1C1=`(not available in source)` (Column header: WDI)

### Data Validations
- None

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: perkeso

### Summary
- **Used range**: `A1:L67`
- **Excel Tables**: None

### Formulas
- None

### Data Validations
- None

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: kwsp

### Summary
- **Used range**: `A1:K403`
- **Excel Tables**: None

### Formulas
- None

### Data Validations
- None

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: shifts

### Summary
- **Used range**: `A1:G4`
- **Excel Tables**: None

### Formulas
- `G2`: A1=`(((C2+(D2="Yes"))-B2)*24)-E2/60`; R1C1=`(not available in source)` (Column header: Planned Hours)
- `G3`: A1=`(((C3+(D3="Yes"))-B3)*24)-E3/60`; R1C1=`(not available in source)` (Column header: 8)
- `G4`: A1=`(((C4+(D4="Yes"))-B4)*24)-E4/60`; R1C1=`(not available in source)` (Column header: 10.999999999999996)

### Data Validations
- None

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: settingsarchive

### Summary
- **Used range**: `A1:P3`
- **Excel Tables**: None

### Formulas
- None

### Data Validations
- None

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: rosterpatterns

### Summary
- **Used range**: `A1:AG3`
- **Excel Tables**: None

### Formulas
- None

### Data Validations
- None

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: rosteroverrides

### Summary
- **Used range**: `A1:D2`
- **Excel Tables**: None

### Formulas
- None

### Data Validations
- None

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None

## Sheet: holidays

### Summary
- **Used range**: `A1:G33`
- **Excel Tables**: None

### Formulas
- `E2`: A1=`IFERROR(
  INDEX($A$2:$A$200,
    MATCH(
      SMALL(
        IF(
          ISNUMBER(MATCH(TRIM(SUBSTITUTE($C$2:$C$200," Holiday","")),$D$2:$D$30,0)),
          MATCH(TRIM(SUBSTITUTE($C$2:$C$200," Holiday","")),$D$2:$D$30,0)*1000000 + $A$2:$A$200,
          ""
        ),
        _xlfn.SEQUENCE(11)
      ),
      IF(
        ISNUMBER(MATCH(TRIM(SUBSTITUTE($C$2:$C$200," Holiday","")),$D$2:$D$30,0)),
        MATCH(TRIM(SUBSTITUTE($C$2:$C$200," Holiday","")),$D$2:$D$30,0)*1000000 + $A$2:$A$200,
        ""
      ),
      0
    )
  ),
"")`; R1C1=`(not available in source)` (Column header: 11 Options)
- `F3`: A1=`1+F2`; R1C1=`(not available in source)` (Column header: 1)
- `F4`: A1=`1+F3`; R1C1=`(not available in source)` (Column header: 2)
- `F5`: A1=``; R1C1=`(not available in source)` (Column header: 3)
- `F6`: A1=``; R1C1=`(not available in source)` (Column header: 4)
- `F7`: A1=``; R1C1=`(not available in source)` (Column header: 5)
- `F8`: A1=``; R1C1=`(not available in source)` (Column header: 6)
- `F9`: A1=``; R1C1=`(not available in source)` (Column header: 7)
- `F10`: A1=``; R1C1=`(not available in source)` (Column header: 8)
- `F11`: A1=``; R1C1=`(not available in source)` (Column header: 9)
- `F12`: A1=``; R1C1=`(not available in source)` (Column header: 10)

### Data Validations
- `D13:D22 D7:D11`: type=custom operator=None formula1=`COUNTA($E$2:$E$200)<=11` formula2=`None` (Column header: Hari Nuzul Al-Quran)

### Conditional Formatting
- None

### Pivots / Charts
- **Pivot tables**: None
- **Charts**: None


## VBA Modules (Extraction Attempt)

The workbook contains `xl/vbaProject.bin`, but this environment lacks an OLE/VBA parser to reliably extract module text and procedures. Attempted string scanning did not yield readable procedure names. If you can provide a VBA-capable environment (e.g., oletools/olevba), I can re-run for a full module/procedure inventory.
